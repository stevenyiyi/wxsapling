{"version":3,"sources":["components/home_page.js","http_common.js","user_context.js","components/as_tooltip.jsx","components/login.js","components/carousel.js","components/school.js","components/teachers.js","components/recipes.js","components/avatar.js","components/utils.js","components/messages/message.js","components/messages/messages.js","components/info_bar.js","components/user_list.js","components/input.js","components/tlv.js","components/websocket.js","components/chat.js","components/test.js","utils/is.js","utils/elements.js","utils/browser.js","components/camera_list.js","components/jabber.js","components/barrage.js","utils/hook.js","components/snackbar.jsx","components/use_snackbar.js","components/barrage_icon.js","components/hlsplayer.js","components/modal.js","components/change_pwd.js","components/person.js","components/info.js","components/live_player.js","App.js","index.js"],"names":["HomePage","props","axios","create","baseURL","withCredentials","headers","Pragma","Expires","UserContext","React","createContext","user","update_user","ASTooltip","forwardRef","refAnchor","placement","delay","show","onClose","children","refThis","useRef","useEffect","console","log","parentElement","current","childElement","classList","add","appendChild","remove","removeChild","timerId","setTimeout","clearTimeout","ref","className","defaultProps","Login","ERR_NO_ACCOUNT","ERR_INVALID_PWD","navigate","useNavigate","useState","username","password","state","setState","userCtx","useContext","location","useLocation","refBut","text","message","setMessage","handleChange","e","target","id","value","prevState","type","placeholder","onChange","htmlFor","onClick","preventDefault","formIsValid","match","handleFormInvalid","path","h1","sha1","toString","h2","h3","qparams","ts","Date","now","token","http","get","params","then","response","result","data","updateUser","role","Cookies","from","catch","toJSON","Carousel","pics","refSlides","setRefSlides","refDots","setRefDots","slideIndex","setSlideIndex","showSlides","useCallback","i","length","style","display","replace","cidx","elRefs","Array","fill","map","_","createRef","timerid","pic","src","alt","School","useSearchParams","schoolid","school","setSchool","error","photo","photos","split","push","genPhotos","name","introduce","Teachers","searchParams","teachers","setTeachers","classes","setClasses","activeIdx","setActiveIdx","refList","getClassNames","classids","names","clsid","cls","classid","join","handleClose","event","toggle","disabled","idx","f","toggleNextDisabled","uri","genTeacherPhoto","width","nick_name","note","teacher","index","Recipes","recipes","setRecipes","monday","tuesday","wednesday","thursday","friday","Avatar","image","onMouseOver","shape","size","position","setError","loaded","setLoaded","initials","charAt","flexBasis","fontSize","height","lineHeight","title","onError","onLoad","objectFit","parseFrom","fidx","lastIndexOf","Error","name_and_avatar","substring","uid","spair","avatar","genPlayUri","oid","Message","to","content","filename","isSentByCurrentUser","ufrom","genMessageContent","startsWith","ReactEmoji","emojify","fb","Blob","imgUrl","window","URL","webkitURL","createObjectURL","revokeObjectURL","avUrl","autoPlay","muted","controls","fileUrl","href","download","toLocaleString","Number","Messages","messages","InfoBar","unReadMessages","handleNotifications","convState","genClassesName","convStateStr","UserItem","sel","setSelectedUsers","selected","setSelected","prevUsers","filter","prevUser","prevSelected","online","UserList","users","onHide","selectedUsers","refSelf","toggleSelectAll","checked","sels","forEach","element","createElement","defaultChecked","genCheckUsers","includes","Input","my","sendMessage","showUserList","setShowUserList","sendUsers","setSendUsers","sending","setSending","hiddenFileInput","susers","realSendMessage","msg","handleSendMessage","onKeyPress","key","click","file","files","reader","FileReader","onload","readAsArrayBuffer","hidden","tlv_parse_length","dv","cursor","len","getUint8","offset","c","getUint16","getUint32","tlv_endode_length","setInt8","setUint8","setUint16","setUint32","tlv_parse_type","t","getInt8","tlv_parse_string","out","char2","char3","array","Uint8Array","buffer","String","fromCharCode","utf8ArrayToStr","tlv_parse_value","tlv_type","val","tlv_parse_null","tlv_parse_bool","getFloat64","tlv_parse_int","getFloat32","tlv_parse_float","buf","tlv_parse_buffer","arr","tlv_parse_array","tlv_parse_object","tlv_parse_undefined","obj","tlv_encode_string","arrBytes","str","bytes","charCodeAt","stringToArrayBuffer","tlv_encode_variant_end","tlv_encode_value","tlv_encode_null","undefined","tlv_encode_undefined","tlv_encode_bool","isInteger","loffset","lsize","setFloat64","tlv_encode_int","setFloat32","Math","fround","tlv_encode_float","classObject","Object","prototype","call","slice","tlv_encode_object","tlv_encode_array","byteLength","set","ArrayBuffer","tlv_encode_buffer","hasOwnProperty","tlv_serialize_object","msize","sizeOf","objClass","memorySizeOf","DataView","tlv_unserialize_object","Websocket","ws","WebSocket","url","protocol","MozWebSocket","attempts","bind","setupWebsocket","defineProperties","readyState","this","logline","debug","k","reconnectIntervalInMilliSeconds","min","pow","websocket","binaryType","onopen","logging","onOpen","onerror","code","shouldReconnect","reconnect","onmessage","evt","onMessage","onclose","reason","time","generateInterval","timeoutID","close","callback","OPEN","send","setInterval","clearInterval","bufferedAmount","Component","users_reducer","action","cusers","uids","change","Chat","setMy","useReducer","dispatch","setMessages","unreadMessages","setUnreadMessages","members","self","wsmsg","entries","binMsg","prev","Test","poster","preload","getConstructor","input","constructor","instanceOf","Boolean","isNullOrUndefined","isObject","isString","isFunction","Function","isArray","isNodeList","NodeList","isEmpty","keys","isNaN","nodeType","ownerDocument","attributes","document","is","setAttribute","setAttributes","innerText","USER_AGENT","navigator","userAgent","isEdge","test","isChrome","isAndroid","isIPHONE","platform","browser","isIE","documentMode","ieVersion","exec","version","parseFloat","isFirefox","chromeVersion","isWebkit","documentElement","isIPhone","isIos","maxTouchPoints","iosVersion","isIPod","androidVersion","major","minor","isSafari","isWindows","isX5","matches","isTbsX5","isQQX5","supportsMediaSource","mediaSource","MediaSource","WebKitMediaSource","sourceBuffer","SourceBuffer","WebKitSourceBuffer","isTypeSupported","sourceBufferValidAPI","appendBuffer","supportsNativeFullscreen","fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled","supportsShadowDOM","HTMLElement","attachShadow","supportsWASM","WebAssembly","instantiate","module","Module","of","Instance","pip","webkitSetPresentationMode","pictureInPictureEnabled","disablePictureInPicture","airplay","WebKitPlaybackTargetAvailabilityEvent","CameraList","camlist","onPlayUri","cameras","setCameras","groups","setGroups","currentCamera","setCurrentCamera","clist","robj","fixed","cam","group","getCurrentPlayCam","playuri","is_main_stream","dcams","status","cgroups","theArray","fixCameraList","newcams","concat","onClickCamera","onClickGroup","gid","Jabber","toLocaleTimeString","hour12","tracks_reducer","tracks","working","startTs","performance","is_changed","track","interval","hasFreeTracks","Barrage","refMessages","tracksState","dispatchTracksState","actionState","shift","useOutsideClick","onOutsideClick","handleClickOutside","contains","addEventListener","removeEventListener","defaultPosition","defaultDuration","positions","SnackbarContext","Snackbar","open","setOpen","timeoutId","setTimeoutId","setText","duration","setDuration","setPosition","customStyles","setCustomStyles","closeCustomStyles","setCloseCustomStyles","triggerSnackbar","closeStyle","closeSnackbar","Provider","openSnackbar","CSSTransition","in","timeout","mountOnEnter","unmountOnExit","onEnter","classNames","enter","enterActive","exitActive","CloseIcon","viewBox","d","fillRule","useSnackbar","BarrageIconOn","marginLeft","xmlns","BarrageIconOff","screen","lockOrientationUniversal","mode","orientation","lock","err","mozLockOrientation","msLockOrientation","angle","has_audio","media","mozHasAudio","webkitAudioDecodedByteCount","audioTracks","get_duration","realDuration","Infinity","HLSPlayer","autoplay","hlsConfig","videoProps","onRefreshCamlist","onSendMessage","onPlayChange","dimensions","setDimensions","checkMpd","setCheckMpd","streamUri","setStreamUri","seekval","setSeekval","NaN","hasAudio","setHasAudio","setMuted","volume","setVolume","loading","setLoading","isFullScreen","setIsFullScreen","isBarrage","setIsBarrage","x","y","scrollPosition","setScrollPosition","cleanupViewport","setCleanupViewport","barrageMessage","setBarrageMessage","refVidContainer","refHls","refVideo","refControls","refFsMenuBut","refFsMenu","tryPlaying","hasaudio","play","msePlay","mutual","Hls","attachMedia","on","Events","MEDIA_ATTACHED","loadSource","MANIFEST_PARSED","ERROR","fatal","ErrorTypes","MEDIA_ERROR","recoverMediaError","details","stopLoad","detachMedia","destory","NETWORK_ERROR","ErrorDetails","MANIFEST_LOAD_ERROR","LEVEL_LOAD_ERROR","AUDIO_TRACK_LOAD_ERROR","FRAG_LOAD_ERROR","KEY_LOAD_ERROR","rcode","MANIFEST_LOAD_TIMEOUT","KEY_LOAD_TIMEOUT","LEVEL_LOAD_TIMEOUT","MANIFEST_PARSING_ERROR","LEVEL_EMPTY_ERROR","nativePlay","load","oncanplaythrough","pause","removeAttribute","networkState","MediaError","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ABORTED","useLayoutEffect","offsetWidth","offsetHeight","last","fetch","credentials","Accept","cache","method","respText","isSupported","handleVideoEvent","currentTime","registerVideoEvents","videoElement","canPlayType","destroy","toggleDivFullscreen","pageXOffset","pageYOffset","scrollTo","body","overflow","viewport","head","querySelector","property","hasProperty","part","trim","fse","CustomEvent","detail","dispatchEvent","toggleNativeFullscreen","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","Element","ALLOW_KEYBOARD_INPUT","exitFullscreen","cancelFullScreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","rotationHandler","currentAngle","paused","prefix","some","pre","get_fullscreen_prefix","eventName","isfs","fullscreenElement","msFullscreenElement","mozFullScreenElement","webkitFullscreenElement","handleFullscreenChange","onchange","hieght","crossOrigin","playsInline","max","defaultValue","step","webkitPresentationMode","pictureInPictureElement","exitPictureInPicture","requestPictureInPicture","webkitShowPlaybackTargetPicker","flag","playUri","liveDurationInfinity","xhrSetup","xhr","responseType","fetchSetup","context","initParams","Request","Modal","refModal","ChangePassword","oldPwd","setOldPwd","newPwd","setNewPwd","confirmPwd","setConfirmPwd","calcToken","CryptoJS","SHA1","onSubmit","oldpwd","isok","ctoken","validateOldPwd","bkey","MD5","benc","AES","encrypt","iv","CTR","padding","pad","NoPadding","senc","enc","Hex","stringify","required","Person","setUser","end_ts","showChangePwd","setShowChangePwd","refAvatar","info","useImperativeHandle","getName","getEndts","getPhoto","accept","selectedFile","ext","pop","mfields","FormData","append","upload_file","post","Info","LivePlayer","setCamlist","camsRefreshId","setCamsRefreshId","showPerson","setShowPerson","showInfo","setShowInfo","chatText","setChatText","refPersonBut","refInfoBut","refPerson","ok","resp","json","handleRefreshCamList","rid","handlePalyChange","handlePersonClose","handleInfoClose","assemblySendMessage","handleJabberFromPlayer","handleJabber","hlsconfig","useMemo","App","userContext","setUserContext","rootElement","getElementById","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.cd2acce8.chunk.js","sourcesContent":["import React from \"react\";\n\nexport default function HomePage(props) {\n  return <div>hello,HomePage!</div>;\n}\n","import axios from \"axios\";\n\nexport default axios.create({\n  baseURL: \"https://localhost/\",\n  withCredentials: true, // 允许携带cookie\n  headers: {\n    \"Content-type\": \"application/json\",\n    \"Cache-Control\": \"no-cache\",\n    Pragma: \"no-cache\",\n    Expires: \"0\"\n  }\n});\n","import React from \"react\";\nexport const UserContext = React.createContext({\n  user: null,\n  update_user: (user) => {}\n});\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport \"./as_tooltip.css\";\nconst ASTooltip = React.forwardRef((props, refAnchor) => {\n  const { placement, delay, show, onClose, children } = props;\n  const refThis = React.useRef();\n\n  React.useEffect(() => {\n    console.log(\"add tooltip element to refAnchor!\");\n    const parentElement = refAnchor.current;\n    const childElement = refThis.current;\n    parentElement.classList.add(\"tooltip\");\n    parentElement.appendChild(childElement);\n    return () => {\n      parentElement.classList.remove(\"tooltip\");\n      parentElement.removeChild(childElement);\n    };\n  }, [refAnchor]);\n\n  React.useEffect(() => {\n    let timerId = 0;\n    if (show) {\n      refThis.current.classList.add(\"visible\");\n      if (delay > 0) {\n        timerId = setTimeout(() => {\n          onClose();\n        }, delay);\n      }\n    } else {\n      refThis.current.classList.remove(\"visible\");\n    }\n    return () => {\n      if (timerId > 0) {\n        clearTimeout(timerId);\n      }\n    };\n  }, [delay, show, onClose]);\n  return (\n    <div ref={refThis} className={`tooltiptext ${placement}`}>\n      {children}\n    </div>\n  );\n});\n\nASTooltip.propTypes = {\n  placement: PropTypes.oneOf([\"top\", \"bottom\", \"left\", \"right\"]),\n  delay: PropTypes.number.isRequired,\n  show: PropTypes.bool.isRequired,\n  onClose: PropTypes.func.isRequired\n};\n\nASTooltip.defaultProps = {\n  placement: \"top\",\n  delay: 0,\n  show: false,\n  onClose: () => {}\n};\n\nexport default ASTooltip;\n","import React from \"react\";\nimport http from \"../http_common\";\nimport sha1 from \"crypto-js/sha1\";\nimport Cookies from \"js-cookie\";\nimport { UserContext } from \"../user_context\";\nimport ASTooltip from \"./as_tooltip\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport \"./login.css\";\nimport \"./floating_input.css\";\nconst Login = (props) => {\n  const ERR_NO_ACCOUNT = 0x800000f;\n  const ERR_INVALID_PWD = ERR_NO_ACCOUNT + 1;\n  const ERR_OVERDUE = ERR_INVALID_PWD + 1;\n  const navigate = useNavigate();\n  const [state, setState] = React.useState({\n    username: \"\",\n    password: \"\"\n  });\n\n  const userCtx = React.useContext(UserContext);\n  const location = useLocation();\n  const refBut = React.useRef();\n  const [message, setMessage] = React.useState({\n    show: false,\n    text: \"\"\n  });\n\n  const handleChange = (e) => {\n    const { id, value } = e.target;\n    setState((prevState) => ({\n      ...prevState,\n      [id]: value\n    }));\n  };\n\n  const handleFormInvalid = () => {\n    let formIsValid = true;\n    if (\n      !state.username.match(\n        /^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/\n      )\n    ) {\n      formIsValid = false;\n      setMessage({\n        ...message,\n        show: true,\n        text: \"非法的用户名，请输入手机号！\"\n      });\n      return formIsValid;\n    } else {\n      formIsValid = true;\n    }\n\n    if (!state.password.match(/^[0-9a-zA-Z]{6,22}$/)) {\n      formIsValid = false;\n      setMessage({\n        ...message,\n        show: true,\n        text: \"口令限制仅英文字母或数字组成，长度范围(6-22)个字符\"\n      });\n      return formIsValid;\n    } else {\n      formIsValid = true;\n    }\n    return formIsValid;\n  };\n\n  const redirectToCurrent = () => {\n    if (location.state) {\n      navigate(location.state.from);\n    }\n  };\n\n  const handleSubmitClick = (e) => {\n    e.preventDefault();\n    if (handleFormInvalid()) {\n      let path = \"/sapling/login\";\n      let h1 = sha1(state.username + \":\" + state.password).toString();\n      let h2 = sha1(state.password + \":\" + path).toString();\n      let h3 = sha1(\n        state.username + \":\" + state.password + \":\" + path\n      ).toString();\n      let qparams = { ts: Date.now() };\n      qparams.username = state.username;\n      qparams.token = sha1(h1 + \":\" + h2 + \":\" + h3).toString();\n      http\n        .get(path, { params: qparams })\n        .then((response) => {\n          let result = response.data.result;\n          if (result === 0) {\n            userCtx.updateUser({\n              username: state.username,\n              role: Cookies.get(\"role\"),\n              token: Cookies.get(\"token\")\n            });\n            /// Login Success\n            setMessage({\n              ...message,\n              show: true,\n              text: \"登录成功,将转向主页!\"\n            });\n            redirectToCurrent();\n          } else if (result === ERR_NO_ACCOUNT) {\n            /// 帐户不存在\n            setMessage({\n              ...message,\n              show: true,\n              text: \"帐户不存在，请先注册后再登录！\"\n            });\n          } else if (result === ERR_OVERDUE) {\n            /// 帐户过期\n            setMessage({\n              ...message,\n              show: true,\n              text: \"帐户已过期!\"\n            });\n          } else if (result === ERR_INVALID_PWD) {\n            /// 口令错误\n            setMessage({\n              ...message,\n              show: true,\n              text: \"口令错误！\"\n            });\n          }\n        })\n        .catch((e) => {\n          /// 错误\n          setMessage({\n            ...message,\n            show: true,\n            text: e.toJSON().message\n          });\n        });\n    }\n  };\n  return (\n    <div className=\"loginOuterContainer\">\n      <div className=\"loginInnerContainer\">\n        <h1 className=\"heading\">用户登录</h1>\n        <div className=\"form__div\">\n          <input\n            className=\"form__input\"\n            id=\"username\"\n            type=\"text\"\n            placeholder=\" \"\n            onChange={handleChange}\n          />\n          <label className=\"form__label\" htmlFor=\"username\">\n            用户名\n          </label>\n        </div>\n        <div className=\"form__div\">\n          <input\n            className=\"form__input\"\n            type=\"password\"\n            id=\"password\"\n            placeholder=\" \"\n            onChange={handleChange}\n          />\n          <label className=\"form__label\" htmlFor=\"password\">\n            口令\n          </label>\n        </div>\n        <button\n          ref={refBut}\n          className={\"button mt-20\"}\n          type=\"submit\"\n          onClick={handleSubmitClick}\n        >\n          登 录\n        </button>\n      </div>\n      <ASTooltip\n        ref={refBut}\n        delay={5000}\n        show={message.show}\n        onClose={() => setMessage({ ...message, show: false })}\n      >\n        <p>{message.text}</p>\n      </ASTooltip>\n    </div>\n  );\n};\nexport default Login;\n","import React from \"react\";\nimport \"./carousel.css\";\n\nexport default function Carousel(props) {\n  const { pics } = props;\n  const [refSlides, setRefSlides] = React.useState([]);\n  const [refDots, setRefDots] = React.useState([]);\n  const [slideIndex, setSlideIndex] = React.useState(0);\n  const showSlides = React.useCallback(() => {\n    for (let i = 0; i < refSlides.length; i++) {\n      refSlides[i].current.style.display = \"none\";\n    }\n    for (let i = 0; i < refDots.length; i++) {\n      refDots[i].current.className = refDots[i].current.className.replace(\n        \" active\",\n        \"\"\n      );\n    }\n    console.log(`Current index:${slideIndex}`);\n    refSlides[slideIndex].current.style.display = \"block\";\n    refDots[slideIndex].current.className += \" active\";\n\n    let cidx = slideIndex + 1;\n    setSlideIndex(cidx);\n    if (cidx >= refSlides.length) {\n      setSlideIndex(0);\n    }\n  }, [refSlides, refDots, slideIndex]);\n\n  React.useEffect(() => {\n    // add refs\n    setRefSlides((elRefs) =>\n      Array(pics.length)\n        .fill()\n        .map((_, i) => React.createRef())\n    );\n    setRefDots((elRefs) =>\n      Array(pics.length)\n        .fill()\n        .map((_, i) => React.createRef())\n    );\n  }, [pics]);\n\n  React.useEffect(() => {\n    const timerid = setTimeout(showSlides, 3000); // Change image every 3 seconds\n    return () => clearTimeout(timerid);\n  });\n  return (\n    <div>\n      <div className=\"slideshow-container\">\n        {pics &&\n          pics.map((pic, i) => (\n            <div ref={refSlides[i]} key={i} className=\"mySlides fade\">\n              <div className=\"numbertext\">{`${i + 1} / ${pics.length}`}</div>\n              <img src={`http://localhost/imgs/${pic}`} alt=\"carousel_image\" />\n              <div className=\"text\">test</div>\n            </div>\n          ))}\n      </div>\n      <div className=\"dot-group\">\n        {pics &&\n          pics.map((pic, i) => (\n            <span ref={refDots[i]} key={i} className=\"dot\"></span>\n          ))}\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { useSearchParams } from \"react-router-dom\";\nimport http from \"../http_common\";\nimport Carousel from \"./carousel\";\nimport \"./school.css\";\n\nexport default function School(props) {\n  const [searchParams] = useSearchParams();\n  const schoolid = searchParams.get(\"schoolid\");\n  const [school, setSchool] = React.useState(null);\n  React.useEffect(() => {\n    if (schoolid) {\n      http\n        .get(`/sapling/get_school?schoolid=${schoolid}`)\n        .then((response) => {\n          if (response.data.result === 0) {\n            setSchool(response.data.school);\n          } else {\n            console.log(`Server respsone error code:${response.data.result}`);\n          }\n        })\n        .catch((error) => console.log(error.toJSON().message));\n    }\n  }, [schoolid]);\n  console.log(`schoolid:${schoolid}`);\n  const genPhotos = (photo) => {\n    let photos = [];\n    if (photo) {\n      photos = photo.split(\",\");\n    }\n    photos.push(\"img_mountains_wide.jpeg\");\n    photos.push(\"img_nature_wide.jpeg\");\n    return photos;\n  };\n\n  return (\n    <div className=\"school_container\">\n      {school && <> <Carousel pics={genPhotos(school.photo)} />\n          <p className=\"title\">{school.name}</p>\n          <div className=\"text_content\">{school.introduce}</div>\n          </>\n      }\n    </div>\n  );\n}\n","import React from \"react\";\nimport { useSearchParams } from \"react-router-dom\";\nimport { FaList, FaAngleLeft, FaAngleRight, FaTimes } from \"react-icons/fa\";\nimport http from \"../http_common\";\nimport \"./common.css\";\nexport default function Teachers(props) {\n  const [searchParams] = useSearchParams();\n  const schoolid = searchParams.get(\"schoolid\");\n  const [teachers, setTeachers] = React.useState([]);\n  const [classes, setClasses] = React.useState([]);\n  const [activeIdx, setActiveIdx] = React.useState(0);\n  const refList = React.useRef();\n  React.useEffect(() => {\n    if (schoolid) {\n      /// Get teachers for schoolid\n      http\n        .get(`/sapling/get_teachers?schoolid=${schoolid}`)\n        .then((response) => {\n          if (response.data.result === 0) {\n            console.log(response.data.teachers);\n            setTeachers(response.data.teachers);\n          } else {\n            console.log(`Server response error:${response.data.result}`);\n          }\n        })\n        .catch((e) => console.log(e));\n      /// Get classes from schoolid\n      http\n        .get(`/sapling/get_classes?schoolid=${schoolid}&simple=true`)\n        .then((response) => {\n          if (response.data.result === 0) {\n            console.log(response.data.classes);\n            setClasses(response.data.classes);\n          } else {\n            console.log(`Server response error:${response.data.result}`);\n          }\n        })\n        .catch((e) => console.log(e));\n    }\n  }, [schoolid]);\n\n  const getClassNames = (classids) => {\n    let names = [];\n    for (const clsid of classids) {\n      for (const cls of classes) {\n        if (cls.classid === clsid) {\n          names.push(cls.name);\n          break;\n        }\n      }\n    }\n    return names.join();\n  };\n\n  const handleClickTeacher = (idx) => {\n    setActiveIdx(idx);\n  };\n\n  const handleClose = (event) => {\n    refList.current.classList.toggle(\"show\");\n  };\n\n  const handleListClick = (event) => {\n    refList.current.classList.toggle(\"show\");\n  };\n\n  const handlePrevClick = (event) => {\n    setActiveIdx((idx) => idx - 1);\n  };\n\n  const toggleNextDisabled = () => {\n    let f = true;\n    if (teachers.length > 0) {\n      if (activeIdx < teachers.length - 1) {\n        f = false;\n      } else {\n        f = true;\n      }\n    }\n    return f;\n  };\n\n  const togglePrevDisabled = () => {\n    return activeIdx === 0;\n  };\n\n  const handleNextClick = (event) => {\n    setActiveIdx((idx) => idx + 1);\n  };\n\n  const genTeachersList = () => {\n    return (\n      <div className=\"user-list__container\">\n        {teachers.map((teacher, index) => (\n          <div\n            className={\n              index === activeIdx\n                ? \"user-item__wrapper user-item__selected\"\n                : \"user-item__wrapper\"\n            }\n            key={teacher.username}\n            id={index}\n            onClick={() => {\n              handleClickTeacher(index);\n              handleClose();\n            }}\n          >\n            <div className=\"user-item__name-wrapper\">\n              <div className=\"user-item__name\">{teacher.nick_name}</div>\n            </div>\n            <p>{getClassNames(teacher.classes)}</p>\n          </div>\n        ))}\n      </div>\n    );\n  };\n\n  const genTeacherPhoto = () => {\n    let uri = \"http://localhost/imgs/img_avatar_unknow.png\";\n    if (teachers.length > 0 && teachers[activeIdx].photo) {\n      uri = `imgs/${teachers[activeIdx].photo}`;\n    }\n    return uri;\n  };\n\n  return (\n    <div className=\"container\">\n      <div className=\"topbar\">\n        <button className=\"circle_btn\" onClick={handleListClick}>\n          <FaList />\n        </button>\n        <h3>教师介绍</h3>\n        <div>\n          <button\n            className=\"circle_btn\"\n            disabled={togglePrevDisabled()}\n            onClick={handlePrevClick}\n          >\n            <FaAngleLeft />\n          </button>\n          <button\n            className=\"circle_btn\"\n            disabled={toggleNextDisabled()}\n            onClick={handleNextClick}\n          >\n            <FaAngleRight />\n          </button>\n        </div>\n      </div>\n      <div className=\"card\">\n        <img src={genTeacherPhoto()} alt=\"teacher\" style={{ width: \"100%\" }} />\n        <p className=\"title\">\n          {teachers.length > 0 ? teachers[activeIdx].nick_name : \"测试\"}\n        </p>\n        <div className=\"text_content\">\n          {teachers.length > 0 ? teachers[activeIdx].note : \"\"}\n        </div>\n      </div>\n      <div ref={refList} className=\"sidenav\">\n        <div className=\"navbar\">\n          <p>教师列表</p>\n          <button className=\"circle_btn\" onClick={handleClose}>\n            <FaTimes />\n          </button>\n        </div>\n        {genTeachersList()}\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { useSearchParams } from \"react-router-dom\";\nimport http from \"../http_common\";\nimport \"./common.css\";\n\nexport default function Recipes(props) {\n  const [searchParams] = useSearchParams();\n  const schoolid = searchParams.get(\"schoolid\");\n  const [recipes, setRecipes] = React.useState(null);\n\n  React.useEffect(() => {\n    if (schoolid) {\n      http\n        .get(`/sapling/get_recipes?schoolid=${schoolid}`)\n        .then((response) => {\n          if (response.data.result === 0) {\n            setRecipes(response.data.recipes);\n          } else {\n            console.log(`Server response code:${response.data.result}`);\n          }\n        })\n        .catch((e) => console.log(e.toJSON().message));\n    }\n  });\n  return (\n    <div className=\"tableContainer\">\n      <table>\n        <thead>\n          <tr>\n            <th>星期</th>\n            <th>食谱</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr>\n            <td>星期一</td>\n            <td>{recipes ? recipes.monday : \"\"}</td>\n          </tr>\n          <tr>\n            <td>星期二</td>\n            <td>{recipes ? recipes.tuesday : \"\"}</td>\n          </tr>\n          <tr>\n            <td>星期三</td>\n            <td>{recipes ? recipes.wednesday : \"\"}</td>\n          </tr>\n          <tr>\n            <td>星期四</td>\n            <td>{recipes ? recipes.thursday : \"\"}</td>\n          </tr>\n          <tr>\n            <td>星期五</td>\n            <td>{recipes ? recipes.friday : \"\"}</td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  );\n}\n","import React, { useEffect, useState } from \"react\";\nimport \"./avatar.scss\";\n/**\n * A round avatar image with fallback to username's first letter\n */\nexport default function Avatar(props) {\n  const {\n    image,\n    name = \"\",\n    onClick = () => undefined,\n    onMouseOver = () => undefined,\n    shape = \"circle\",\n    size = 32,\n    position = \"left\"\n  } = props;\n\n  const [error, setError] = useState(false);\n  const [loaded, setLoaded] = useState(false);\n\n  useEffect(() => {\n    setError(false);\n    setLoaded(false);\n  }, [image]);\n\n  const initials = (name?.toString() || \"\").charAt(0);\n\n  return (\n    <div\n      className={`str-chat__avatar str-chat__avatar--${shape} str-chat__avatar--${position}`}\n      data-testid=\"avatar\"\n      onClick={onClick}\n      onMouseOver={onMouseOver}\n      style={{\n        flexBasis: `${size}px`,\n        fontSize: `${size / 2}px`,\n        height: `${size}px`,\n        lineHeight: `${size}px`,\n        width: `${size}px`\n      }}\n      title={name}\n    >\n      {image && !error ? (\n        <img\n          alt={initials}\n          className={`str-chat__avatar-image${\n            loaded ? \" str-chat__avatar-image--loaded\" : \"\"\n          }`}\n          data-testid=\"avatar-img\"\n          onError={() => setError(true)}\n          onLoad={() => setLoaded(true)}\n          src={image}\n          style={{\n            flexBasis: `${size}px`,\n            height: `${size}px`,\n            objectFit: \"cover\",\n            width: `${size}px`\n          }}\n        />\n      ) : (\n        <div\n          className=\"str-chat__avatar-fallback\"\n          data-testid=\"avatar-fallback\"\n        >\n          {initials}\n        </div>\n      )}\n    </div>\n  );\n}\n","const parseFrom = (from) => {\n  /** name:avatar@username */\n  let fidx = from.lastIndexOf(\"@\");\n  if (fidx < 0) {\n    throw Error(`Invalid message from field:${from}`);\n  }\n  let name_and_avatar = from.substring(0, fidx);\n  let uid = from.substring(fidx + 1);\n  let spair = name_and_avatar.split(\":\");\n  if (spair.length !== 2) {\n    throw Error(`Invalid message from field:${from}`);\n  }\n  return {\n    username: uid,\n    name: spair[0],\n    avatar: spair[1]\n  };\n};\n\n/** 根据oid产生播放地址 */\nconst genPlayUri = (oid) => {\n  let uri = \"https://anylooker.com/live/\" + oid + \"_master.m3u8\";\n  return uri;\n};\nexport { parseFrom, genPlayUri };\n","import React from \"react\";\nimport \"./message.css\";\nimport ReactEmoji from \"react-emoji\";\nimport Avatar from \"../avatar\";\nimport { FaDownload } from \"react-icons/fa\";\nimport PropTypes from \"prop-types\";\nimport { parseFrom } from \"../utils\";\n\nconst Message = (props) => {\n  const { to, from, type, content, ts, filename } = props;\n  let isSentByCurrentUser = false;\n  let ufrom = parseFrom(from);\n  if (ufrom.username === to) {\n    isSentByCurrentUser = true;\n  }\n\n  const genMessageContent = (type, content, filename) => {\n    if (type.startsWith(\"text\")) {\n      return <p>{ReactEmoji.emojify(content)}</p>;\n    } else if (type.startsWith(\"image\")) {\n      let fb = new Blob([content], { type: type, name: filename });\n      let imgUrl = (window.URL || window.webkitURL).createObjectURL(fb);\n      return (\n        <div className=\"messageContainer--image\">\n          <img\n            src={imgUrl}\n            onLoad={() => URL.revokeObjectURL(imgUrl)}\n            alt=\"assets\"\n          />\n        </div>\n      );\n    } else if (type.startsWith(\"video\") || type.startsWith(\"audio\")) {\n      let fb = new Blob([content], { type: type, name: filename });\n      let avUrl = (window.URL || window.webkitURL).createObjectURL(fb);\n      return (\n        <div className=\"messageContainer--video\">\n          <video autoPlay muted controls>\n            <source\n              src={avUrl}\n              onLoad={() => URL.revokeObjectURL(avUrl)}\n              type={type}\n            />\n            您的浏览器不支持HTML5视频播放.\n          </video>\n        </div>\n      );\n    } else {\n      let fb = new Blob([content], { type: type, name: filename });\n      let fileUrl = (window.URL || window.webkitURL).createObjectURL(fb);\n      return (\n        <p>\n          <a href={fileUrl} download>\n            <FaDownload />\n            <span>{filename}</span>\n          </a>\n        </p>\n      );\n    }\n  };\n\n  return isSentByCurrentUser ? (\n    <div className=\"messageContainer justifyStart\">\n      <Avatar\n        image={ufrom.avatar ? `/imgs/${ufrom.username}.${ufrom.avatar}` : \"\"}\n        name={ufrom.name}\n        size={48}\n        position=\"left\"\n      />\n      {genMessageContent(type, content, filename)}\n      <span className=\"time-right\">{`${ufrom.name}  ${new Date(\n        ts\n      ).toLocaleString()}`}</span>\n    </div>\n  ) : (\n    <div className=\"messageContainer darker\">\n      <Avatar\n        image={ufrom.avatar ? `/imgs/${ufrom.username}.${ufrom.avatar}` : \"\"}\n        name={ufrom.name}\n        size={48}\n        position=\"right\"\n      />\n      {genMessageContent(type, content, filename)}\n      <span className=\"time-left\">{`${ufrom.name}  ${new Date(\n        Number(ts)\n      ).toLocaleString()}`}</span>\n    </div>\n  );\n};\n\nMessage.propTypes = {\n  from: PropTypes.string.isRequired,\n  to: PropTypes.string.isRequired,\n  type: PropTypes.string.isRequired,\n  content: PropTypes.any,\n  ts: PropTypes.number.isRequired\n};\n\nMessage.defaultProps = {\n  from: \"成怡\",\n  to: \"成怡\",\n  type: \"text\",\n  content: \"今天还好吗?\",\n  ts: Date.now()\n};\n\nexport default Message;\n","import React from \"react\";\n\nimport ScrollToBottom from \"react-scroll-to-bottom\";\n\nimport Message from \"./message\";\n\nimport \"./messages.css\";\n\nexport default function Messages(props) {\n  const { messages } = props;\n  return (\n    <div className=\"messages-container\">\n    <ScrollToBottom className=\"messages\">\n      {messages &&\n        messages.map((message, i) => (\n          <div key={i}>\n            <Message\n              to={message.to}\n              from={message.from}\n              type={message.type}\n              content={message.content}\n              ts={message.ts}\n              filename={message.filename}\n            />\n          </div>\n        ))}\n    </ScrollToBottom>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { FaBell } from \"react-icons/fa\";\nimport \"./info_bar.css\";\n\nconst InfoBar = ({ classes, state, unReadMessages, handleNotifications }) => {\n  const genClassesName = (classes) => {\n    const names = classes.map((cls) => cls.name);\n    return names.join();\n  };\n\n  const convState = (state) => {\n    switch (state) {\n      case 1:\n        return \"online\";\n      default:\n        return \"offline\";\n    }\n  };\n  const convStateStr = (state) => {\n    switch (state) {\n      case 0:\n        return \"正在连接...\";\n      case 1:\n        return \"已经连接\";\n      case 2:\n        return \"连接正在关闭\";\n      case 3:\n        return \"连接已关闭\";\n      default:\n        return \"非法的状态码\";\n    }\n  };\n  return (\n    <div className=\"infoBar\">\n      <div className=\"leftInnerContainer\">\n        <div className={`room__state ${convState(state)}`} />\n        <h3>{classes ? genClassesName(classes) : \"测试\"}</h3>\n        <p>{convStateStr(state)}</p>\n      </div>\n      <div className=\"rightInnerContainer\">\n        <div className=\"chat__notification\" onClick={handleNotifications}>\n          <FaBell />\n          {unReadMessages > 0 ? (\n            <span className=\"badge\">{unReadMessages}</span>\n          ) : null}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default InfoBar;\n","import React from \"react\";\nimport Avatar from \"./avatar\";\nimport { FaTimes, FaCheck } from \"react-icons/fa\";\nimport \"./common.css\";\nimport \"./user_list.css\";\nconst UserItem = ({ user, sel, setSelectedUsers }) => {\n  const [selected, setSelected] = React.useState(false);\n  React.useEffect(() => {\n    setSelected(sel);\n  }, [sel]);\n  const handleSelect = () => {\n    if (selected) {\n      setSelectedUsers((prevUsers) =>\n        prevUsers.filter((prevUser) => prevUser !== user.username)\n      );\n    } else {\n      setSelectedUsers((prevUsers) => [...prevUsers, user.username]);\n    }\n    setSelected((prevSelected) => !prevSelected);\n  };\n\n  return (\n    <div className=\"user-item__wrapper\" onClick={handleSelect}>\n      <div className=\"user-item__name-wrapper\">\n        <Avatar\n          image={user.image}\n          name={user.nick_name || user.username}\n          size={32}\n        />\n        <p className=\"user-item__name\">{user.nick_name || user.username}</p>\n      </div>\n      {user.online ? (\n        <div className=\"user-item__state-online\" />\n      ) : (\n        <div className=\"user-item__state-offline\" />\n      )}\n      <div className=\"user-item__invite-empty\">{selected && <FaCheck />}</div>\n    </div>\n  );\n};\n\nexport default function UserList({\n  users,\n  show,\n  onHide,\n  selectedUsers,\n  setSelectedUsers\n}) {\n  const refSelf = React.useRef();\n  const handleClose = (event) => {\n    event.preventDefault();\n    onHide();\n  };\n\n  const toggleSelectAll = (e) => {\n    if (e.target.checked) {\n      let sels = [];\n      users.forEach((element) => {\n        sels.push(element.username);\n      });\n      setSelectedUsers(sels);\n    } else {\n      setSelectedUsers([]);\n    }\n  };\n\n  React.useEffect(() => {\n    if (show) {\n      refSelf.current.style.display = \"block\";\n    } else {\n      refSelf.current.style.display = \"none\";\n    }\n  }, [show]);\n\n  const genCheckUsers = () => {\n    let selected =\n      users && users.length === selectedUsers.length ? true : false;\n    return React.createElement(\"input\", {\n      type: \"checkbox\",\n      id: \"chk-user-list-all\",\n      name: \"chk-user-list-all\",\n      defaultChecked: { selected },\n      onChange: toggleSelectAll\n    });\n  };\n\n  return (\n    <div ref={refSelf} className=\"sidenav\">\n      <div className=\"navbar\">\n        <label htmlFor=\"chk-user-list-all\" className=\"switch\">\n          {genCheckUsers()}\n          <span className=\"slider round\"></span>\n        </label>\n        <button className=\"circle_btn\" onClick={handleClose}>\n          <FaTimes />\n        </button>\n      </div>\n      <div className=\"user-list__container\">\n        {users &&\n          users.map((user, i) => (\n            <UserItem\n              index={i}\n              key={user.username}\n              user={user}\n              sel={selectedUsers.includes(user.username) ? true : false}\n              setSelectedUsers={setSelectedUsers}\n            />\n          ))}\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport UserList from \"./user_list\";\nimport PropTypes from \"prop-types\";\nimport {\n  FaTelegramPlane,\n  FaUsers,\n  FaPaperclip,\n  FaSpinner\n} from \"react-icons/fa\";\nimport \"./input.css\";\n\nconst Input = (props) => {\n  const { users, my, sendMessage } = props;\n  const [showUserList, setShowUserList] = React.useState(false);\n  const [sendUsers, setSendUsers] = React.useState([]);\n  const [message, setMessage] = React.useState(\"\");\n  const [sending, setSending] = React.useState(false);\n  // Create a reference to the hidden file input element\n  const hiddenFileInput = React.useRef(null);\n\n  React.useEffect(() => {\n    const susers = users.map((user) => user.username);\n    setSendUsers(susers);\n  }, [users]);\n\n  const handleShowUserList = (event) => {\n    event.preventDefault();\n    setShowUserList(!showUserList);\n  };\n\n  // Programatically click the hidden file input element\n  // when the Button component is clicked\n  const handleFileUploadClick = (event) => {\n    event.preventDefault();\n    hiddenFileInput.current.click();\n  };\n\n  const realSendMessage = (msg) => {\n    setSending(true);\n    sendMessage(msg, (result) => {\n      setSending(false);\n      if (result === 0) {\n        console.log(\"Send message success!\");\n        setMessage(\"\");\n      }\n    });\n  };\n\n  const handleFileChange = (event) => {\n    let file = event.target.files[0];\n    console.log(`File name:${file.name} size:${file.size} type:${file.type}`);\n    let reader = new FileReader();\n    reader.onload = (e) => {\n      let msg = {};\n      msg.to = sendUsers;\n      msg.from = my.nick_name + \":\" + my.photo + \"@\" + my.username;\n      msg.type = file.type;\n      msg.filename = file.name;\n      msg.content = e.target.result;\n      msg.ts = Date.now();\n      realSendMessage(msg);\n    };\n    reader.readAsArrayBuffer(file);\n  };\n\n  const handleSendMessage = () => {\n    if (message) {\n      console.log(sendUsers);\n      let msg = {};\n      msg.to = sendUsers;\n      msg.from = my.nick_name + \":\" + my.photo + \"@\" + my.username;\n      msg.type = \"text\";\n      msg.content = message;\n      msg.ts = Date.now();\n      realSendMessage(msg);\n    }\n  };\n\n  return (\n    <form className=\"form\">\n      <input\n        className=\"input\"\n        type=\"text\"\n        value={message}\n        placeholder=\"输入消息\"\n        onChange={(event) => setMessage(event.target.value)}\n        onKeyPress={(event) => {\n          if (event.key === \"Enter\") {\n            event.preventDefault();\n            handleSendMessage();\n          }\n        }}\n      />\n      <button\n        id=\"but-select-users\"\n        className=\"image-button\"\n        onClick={handleShowUserList}\n      >\n        <FaUsers size={24} />\n      </button>\n\n      <button\n        id=\"file-select-message-button\"\n        className=\"image-button\"\n        onClick={handleFileUploadClick}\n      >\n        <FaPaperclip size={24} />\n      </button>\n      <input\n        ref={hiddenFileInput}\n        id=\"file-select-message-input\"\n        type=\"file\"\n        onChange={handleFileChange}\n        hidden\n      />\n\n      <button\n        id=\"but-send-message\"\n        className=\"image-button\"\n        onClick={(e) => {\n          e.preventDefault();\n          handleSendMessage();\n        }}\n        disabled={sending ? true : false}\n      >\n        {sending ? (\n          <FaSpinner size={24} className=\"spinner\" />\n        ) : (\n          <FaTelegramPlane size={24} />\n        )}\n      </button>\n      <UserList\n        users={users}\n        show={showUserList}\n        onHide={() => setShowUserList(false)}\n        selectedUsers={sendUsers}\n        setSelectedUsers={setSendUsers}\n      />\n    </form>\n  );\n};\nInput.propTypes = {\n  users: PropTypes.array.isRequired,\n  my: PropTypes.object.isRequired\n};\n\nInput.defaultProps = {\n  users: [],\n  my: {}\n};\n\nexport default Input;\n","const TLV_TYPE_END = 0;\nconst TLV_TYPE_STRING = 1;\nconst TLV_TYPE_ARRAY = 2;\nconst TLV_TYPE_OBJECT = 3;\nconst TLV_TYPE_BUFFER = 4;\nconst TLV_TYPE_NULL = 5;\nconst TLV_TYPE_INT = 6;\nconst TLV_TYPE_FLOAT = 7;\nconst TLV_TYPE_BOOL = 8;\nconst TLV_TYPE_UNDEFINED = 9;\n\nfunction memorySizeOf(obj) {\n  let bytes = 0;\n  function sizeOf(obj) {\n    if (obj === null || obj === undefined) {\n      bytes += 2;\n    } else {\n      switch (typeof obj) {\n        case \"number\":\n          bytes += 8 + 6;\n          break;\n        case \"string\":\n          bytes += obj.length * 3 + 6;\n          break;\n        case \"boolean\":\n          bytes += 3;\n          break;\n        case \"object\":\n          var objClass = Object.prototype.toString.call(obj).slice(8, -1);\n          if (objClass === \"Object\") {\n            for (let key in obj) {\n              if (!obj.hasOwnProperty(key)) continue;\n              sizeOf(key);\n              sizeOf(obj[key]);\n              bytes += 4;\n            }\n          } else if (objClass === \"Array\") {\n            for (const element of obj) {\n              sizeOf(element);\n            }\n            bytes += 4;\n          } else if (\n            objClass === \"ArrayBuffer\" ||\n            objClass === \"Uint8Array\" ||\n            objClass === \"Int8Array\" ||\n            objClass === \"Int16Array\" ||\n            objClass === \"Uint16Array\" ||\n            objClass === \"Uint32Array\" ||\n            objClass === \"Int32Array\" ||\n            objClass === \"Float32Array\" ||\n            objClass === \"Float64Array\"\n          ) {\n            bytes += obj.byteLength + 6;\n          } else {\n            bytes += obj.toString().length * 2;\n          }\n          break;\n        default:\n          console.log(obj);\n          throw Error(`Invalid type of object:${typeof obj}`);\n      }\n    }\n    return bytes;\n  }\n  return sizeOf(obj);\n}\n\nfunction stringToArrayBuffer(str) {\n  let bytes = [];\n  let len, c;\n  len = str.length;\n  for (var i = 0; i < len; i++) {\n    c = str.charCodeAt(i);\n    if (c >= 0x010000 && c <= 0x10ffff) {\n      bytes.push(((c >>> 18) & 0x07) | 0xf0);\n      bytes.push(((c >>> 12) & 0x3f) | 0x80);\n      bytes.push(((c >>> 6) & 0x3f) | 0x80);\n      bytes.push((c & 0x3f) | 0x80);\n    } else if (c >= 0x000800 && c <= 0x00ffff) {\n      bytes.push(((c >>> 12) & 0x0f) | 0xe0);\n      bytes.push(((c >>> 6) & 0x3f) | 0x80);\n      bytes.push((c & 0x3f) | 0x80);\n    } else if (c >= 0x000080 && c <= 0x0007ff) {\n      bytes.push(((c >>> 6) & 0x1f) | 0xc0);\n      bytes.push((c & 0x3f) | 0x80);\n    } else {\n      bytes.push(c & 0xff);\n    }\n  }\n  return bytes;\n}\n\nfunction utf8ArrayToStr(dv, cursor, len) {\n  let out, i, c;\n  let char2, char3;\n\n  out = \"\";\n  i = 0;\n\n  let array = new Uint8Array(dv.buffer, cursor.offset, len);\n  while (i < len) {\n    c = array[i++];\n    switch (c >>> 4) {\n      case 0:\n      case 1:\n      case 2:\n      case 3:\n      case 4:\n      case 5:\n      case 6:\n      case 7:\n        // 0xxxxxxx\n        out += String.fromCharCode(c);\n        break;\n      case 12:\n      case 13:\n        // 110x xxxx   10xx xxxx\n        char2 = array[i++];\n        out += String.fromCharCode(((c & 0x1f) << 6) | (char2 & 0x3f));\n        break;\n      case 14:\n        // 1110 xxxx  10xx xxxx  10xx xxxx\n        char2 = array[i++];\n        char3 = array[i++];\n        out += String.fromCharCode(\n          ((c & 0x0f) << 12) | ((char2 & 0x3f) << 6) | ((char3 & 0x3f) << 0)\n        );\n        break;\n      default:\n        break;\n    }\n  }\n  cursor.offset += len;\n  return out;\n}\n\nfunction tlv_parse_length(dv, cursor) {\n  let len = dv.getUint8(cursor.offset);\n  ++cursor.offset;\n  if (len & 0x80) {\n    let c = len & 0x7f;\n    if (c === 0) {\n      /// Nothing to do\n    } else if (c === 1) {\n      len = dv.getUint8(cursor.offset);\n      ++cursor.offset;\n    } else if (c === 2) {\n      len = dv.getUint16(cursor.offset);\n      cursor.offset += 2;\n    } else if (c === 4) {\n      len = dv.getUint32(cursor.offset);\n      cursor.offset += 4;\n    } else {\n      throw new Error(`Invalid tlv length:${c}`);\n    }\n  }\n  return len;\n}\n\nfunction tlv_endode_length(dv, cursor, len) {\n  if (len <= 127) {\n    dv.setInt8(cursor.offset, len);\n    ++cursor.offset;\n  } else if (len > 127 && len <= 255) {\n    dv.setInt8(cursor.offset, 0x80 | 0x01);\n    ++cursor.offset;\n    dv.setUint8(len);\n    ++cursor.offset;\n  } else if (len > 255 && len <= 65535) {\n    dv.setInt8(cursor.offset, 0x80 | 0x02);\n    ++cursor.offset;\n    dv.setUint16(cursor.offset, len);\n    cursor.offset += 2;\n  } else {\n    dv.setInt8(cursor.offset, 0x80 | 0x04);\n    ++cursor.offset;\n    dv.setUint32(cursor.offset, len);\n    cursor.offset += 4;\n  }\n}\n\nfunction tlv_parse_type(dv, cursor) {\n  let t = dv.getInt8(cursor.offset);\n  ++cursor.offset;\n  return t;\n}\n\nfunction tlv_parse_int(dv, cursor) {\n  let val = 0;\n  let len = tlv_parse_length(dv, cursor);\n  if (len === 1) {\n    val = dv.getUint8(cursor.offset);\n  } else if (len === 2) {\n    val = dv.getUint16(cursor.offset);\n  } else if (len === 4) {\n    val = dv.getUint32(cursor.offset);\n  } else if (len === 8) {\n    val = dv.getFloat64(cursor.offset);\n  } else {\n    throw new Error(`Read tlv int, but size is:${len}`);\n  }\n  cursor.offset += len;\n  return val;\n}\n\nfunction tlv_parse_float(dv, cursor) {\n  let val = 0.0;\n  let len = tlv_parse_length(dv, cursor);\n  if (len === 4) {\n    val = dv.getFloat32(cursor.offset);\n  } else if (len === 8) {\n    val = dv.getFloat64(cursor.offset);\n  } else {\n    throw new Error(`Read tlv float, but size is:${len}`);\n  }\n  cursor.offset += len;\n  return val;\n}\n\nfunction tlv_parse_string(dv, cursor) {\n  let len = tlv_parse_length(dv, cursor);\n  return utf8ArrayToStr(dv, cursor, len);\n}\n\nfunction tlv_parse_buffer(dv, cursor) {\n  let len = tlv_parse_length(dv, cursor);\n  let buf = new Uint8Array(dv.buffer, cursor.offset, len);\n  cursor.offset += len;\n  return buf;\n}\n\nfunction tlv_parse_bool(dv, cursor) {\n  let val = false;\n  let len = tlv_parse_length(dv, cursor);\n  if (len !== 1) {\n    throw Error(`Parse tlv bool, but length:${len}`);\n  }\n  val = dv.getInt8(cursor.offset) === 1 ? true : false;\n  ++cursor.offset;\n  return val;\n}\n\nfunction tlv_parse_null(dv, cursor) {\n  let val = null;\n  let len = tlv_parse_length(dv, cursor);\n  if (len !== 0) {\n    throw Error(`Parse tlv null, but length:${len}`);\n  }\n  return val;\n}\n\nfunction tlv_parse_undefined(dv, cursor) {\n  let val = undefined;\n  let len = tlv_parse_length(dv, cursor);\n  if (len !== 0) {\n    throw Error(`Parse tlv undefined, but length:${len}`);\n  }\n  return val;\n}\n\nfunction tlv_parse_value(dv, cursor, tlv_type) {\n  let val = undefined;\n  switch (tlv_type) {\n    case TLV_TYPE_NULL:\n      val = tlv_parse_null(dv, cursor);\n      break;\n    case TLV_TYPE_BOOL:\n      val = tlv_parse_bool(dv, cursor);\n      break;\n    case TLV_TYPE_STRING:\n      val = tlv_parse_string(dv, cursor);\n      break;\n    case TLV_TYPE_INT:\n      val = tlv_parse_int(dv, cursor);\n      break;\n    case TLV_TYPE_FLOAT:\n      val = tlv_parse_float(dv, cursor);\n      break;\n    case TLV_TYPE_BUFFER:\n      val = tlv_parse_buffer(dv, cursor);\n      break;\n    case TLV_TYPE_ARRAY:\n      val = tlv_parse_array(dv, cursor);\n      break;\n    case TLV_TYPE_OBJECT:\n      val = tlv_parse_object(dv, cursor);\n      break;\n    case TLV_TYPE_UNDEFINED:\n      val = tlv_parse_undefined(dv, cursor);\n      break;\n    default:\n      break;\n  }\n  return val;\n}\n\nfunction tlv_parse_object(dv, cursor) {\n  let obj = {};\n  let len = tlv_parse_length(dv, cursor);\n  if (len !== 0x80) {\n    throw Error(\"Parse object but length not 0x80!\");\n  }\n  while (1) {\n    /// name\n    let t = tlv_parse_type(dv, cursor);\n    if (t === TLV_TYPE_END) {\n      if (tlv_parse_length(dv, cursor) === 0) {\n        /// object end\n        break;\n      } else {\n        throw Error(\"Parse object, type end, but length not 0!\");\n      }\n    }\n    if (t !== TLV_TYPE_STRING) {\n      throw new Error(`Parse name, but type is ${t}`);\n    }\n    let name = tlv_parse_string(dv, cursor);\n    /// value\n    t = tlv_parse_type(dv, cursor);\n    obj[name] = tlv_parse_value(dv, cursor, t);\n  }\n  return obj;\n}\n\nfunction tlv_parse_array(dv, cursor) {\n  let arr = [];\n  let len = tlv_parse_length(dv, cursor);\n  if (len !== 0x80) {\n    throw Error(\"Parse array but length not 0x80!\");\n  }\n  while (1) {\n    /// value\n    let t = tlv_parse_type(dv, cursor);\n    if (t === TLV_TYPE_END) {\n      if (tlv_parse_length(dv, cursor) === 0) {\n        /// array end\n        break;\n      } else {\n        throw Error(\"Parse array, type end, but length not 0!\");\n      }\n    }\n    let val = tlv_parse_value(dv, cursor, t);\n    arr.push(val);\n  }\n  return arr;\n}\n\nfunction tlv_encode_string(dv, cursor, val) {\n  dv.setUint8(cursor.offset, TLV_TYPE_STRING);\n  ++cursor.offset;\n  let arrBytes = stringToArrayBuffer(val);\n  tlv_endode_length(dv, cursor, arrBytes.length);\n  /// Copy to array buffer of data view\n  for (let i in arrBytes) {\n    dv.setInt8(cursor.offset, arrBytes[i]);\n    ++cursor.offset;\n  }\n}\n\nfunction tlv_encode_null(dv, cursor) {\n  dv.setInt8(cursor.offset, TLV_TYPE_NULL);\n  ++cursor.offset;\n  dv.setInt8(cursor.offset, 0);\n  ++cursor.offset;\n}\n\nfunction tlv_encode_undefined(dv, cursor) {\n  dv.setInt8(cursor.offset, TLV_TYPE_UNDEFINED);\n  ++cursor.offset;\n  dv.setInt8(cursor.offset, 0);\n  ++cursor.offset;\n}\n\nfunction tlv_encode_variant_end(dv, cursor) {\n  dv.setInt8(cursor.offset, TLV_TYPE_END);\n  ++cursor.offset;\n  dv.setInt8(cursor.offset, 0);\n  ++cursor.offset;\n}\n\nfunction tlv_encode_bool(dv, cursor, val) {\n  /// Type of TLV\n  dv.setInt8(cursor.offset, TLV_TYPE_BOOL);\n  ++cursor.offset;\n  /// Length of TLV\n  dv.setInt8(cursor.offset, 1);\n  ++cursor.offset;\n  /// Value of TLV\n  dv.setInt8(cursor.offset, val ? 1 : 0);\n  ++cursor.offset;\n}\n\nfunction tlv_encode_int(dv, cursor, val) {\n  /// Type of TLV\n  dv.setInt8(cursor.offset, TLV_TYPE_INT);\n  ++cursor.offset;\n  let loffset = cursor.offset;\n  let lsize = 0;\n  ++cursor.offset;\n  if (val <= 0xff) {\n    dv.setUint8(cursor.offset, val);\n    ++cursor.offset;\n    lsize = 1;\n  } else if (val > 0xff && val <= 0xffff) {\n    dv.setUint16(val);\n    cursor.offset += 2;\n    lsize = 2;\n  } else if (val > 0xffff && val <= 0xffffffff) {\n    dv.setUint32(cursor.offset, val);\n    cursor.offset += 4;\n    lsize = 4;\n  } else {\n    dv.setFloat64(cursor.offset, val);\n    cursor.offset += 8;\n    lsize = 8;\n  }\n  /// Length of TLV\n  dv.setInt8(loffset, lsize);\n}\n\nfunction tlv_encode_float(dv, cursor, val) {\n  /// Type of TLV\n  dv.setInt8(cursor.offset, TLV_TYPE_FLOAT);\n  ++cursor.offset;\n  /// Length of TLV\n  dv.setInt8(cursor.offset, 4);\n  ++cursor.offset;\n  /// Value of TLV\n  dv.setFloat32(cursor.offset, Math.fround(val));\n  cursor.offset += 4;\n}\n\nfunction tlv_encode_buffer(dv, cursor, val) {\n  /// Type of TLV\n  dv.setInt8(cursor.offset, TLV_TYPE_BUFFER);\n  ++cursor.offset;\n  /// Length of TLV\n  let len = val.byteLength;\n  tlv_endode_length(dv, cursor, len);\n  /// Copy arraybuffer to buffer of dv\n  new Uint8Array(dv.buffer, cursor.offset, len).set(\n    new Uint8Array(val instanceof ArrayBuffer ? val : val.buffer)\n  );\n  cursor.offset += len;\n}\n\nfunction tlv_encode_value(dv, cursor, val) {\n  if (val === null) {\n    tlv_encode_null(dv, cursor);\n  } else if (typeof val === undefined) {\n    tlv_encode_undefined(dv, cursor);\n  } else if (typeof val === \"boolean\") {\n    tlv_encode_bool(dv, cursor, val);\n  } else if (typeof val === \"number\") {\n    if (Number.isInteger(val)) {\n      tlv_encode_int(dv, cursor, val);\n    } else {\n      tlv_encode_float(dv, cursor, val);\n    }\n  } else if (typeof val === \"string\") {\n    tlv_encode_string(dv, cursor, val);\n  } else if (typeof val === \"object\") {\n    let classObject = Object.prototype.toString.call(val).slice(8, -1);\n    if (classObject === \"Object\") {\n      tlv_encode_object(dv, cursor, val);\n    } else if (classObject === \"Array\") {\n      tlv_encode_array(dv, cursor, val);\n    } else if (\n      classObject === \"ArrayBuffer\" ||\n      classObject === \"Uint8Array\" ||\n      classObject === \"Int8Array\" ||\n      classObject === \"Uint16Array\" ||\n      classObject === \"Int16Array\" ||\n      classObject === \"Uint32Array\" ||\n      classObject === \"Int32Array\" ||\n      classObject === \"Float32Array\" ||\n      classObject === \"Float64Array\"\n    ) {\n      tlv_encode_buffer(dv, cursor, val);\n    } else {\n      console.log(`No processing data type:${classObject}`);\n    }\n  } else {\n    /// Nothing to do\n    console.log(`No processing data type:${typeof val}`);\n  }\n}\n\nfunction tlv_encode_array(dv, cursor, val) {\n  /// Type of TLV\n  dv.setInt8(cursor.offset, TLV_TYPE_ARRAY);\n  ++cursor.offset;\n  /// Variant length\n  dv.setUint8(cursor.offset, 0x80);\n  ++cursor.offset;\n  val.forEach((element) => {\n    tlv_encode_value(dv, cursor, element);\n  });\n  tlv_encode_variant_end(dv, cursor);\n}\n\nfunction tlv_encode_object(dv, cursor, obj) {\n  /// Type of TLV\n  dv.setInt8(cursor.offset, TLV_TYPE_OBJECT);\n  ++cursor.offset;\n  /// Variant length\n  dv.setUint8(cursor.offset, 0x80);\n  ++cursor.offset;\n  for (let key in obj) {\n    if (!obj.hasOwnProperty(key)) continue;\n    console.log(`encode key:${key} value:${obj[key]}`);\n    tlv_encode_string(dv, cursor, key);\n    tlv_encode_value(dv, cursor, obj[key]);\n  }\n  tlv_encode_variant_end(dv, cursor);\n}\n\nfunction tlv_serialize_object(obj) {\n  let msize = memorySizeOf(obj);\n  console.log(`Serialize object memory size:${msize}`);\n  let dv = new DataView(new ArrayBuffer(msize));\n  let cursor = { offset: 0 };\n  tlv_encode_object(dv, cursor, obj);\n  return dv.buffer.slice(0, cursor.offset);\n}\n\nfunction tlv_unserialize_object(data) {\n  let dv = new DataView(data);\n  let cursor = { offset: 0 };\n  let t = dv.getInt8(cursor.offset);\n  cursor.offset += 1;\n  if (t !== TLV_TYPE_OBJECT) {\n    throw Error(`Parse object, but type is:${t}.`);\n  }\n  return tlv_parse_object(dv, cursor);\n}\n\nexport { tlv_serialize_object, tlv_unserialize_object };\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nclass Websocket extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      ws: window.WebSocket\n        ? new window.WebSocket(this.props.url, this.props.protocol)\n        : new window.MozWebSocket(this.props.url, this.props.protocol),\n      attempts: 1\n    };\n    this.sendMessage = this.sendMessage.bind(this);\n    this.setupWebsocket = this.setupWebsocket.bind(this);\n    Object.defineProperties(this, {\n      readyState: {\n        get: function getReadyState() {\n          return this.state.ws.readyState;\n        }\n      }\n    });\n  }\n\n  logging(logline) {\n    if (this.props.debug === true) {\n      console.log(logline);\n    }\n  }\n\n  generateInterval(k) {\n    if (this.props.reconnectIntervalInMilliSeconds > 0) {\n      return this.props.reconnectIntervalInMilliSeconds;\n    }\n    return Math.min(30, Math.pow(2, k) - 1) * 1000;\n  }\n\n  setupWebsocket() {\n    let websocket = this.state.ws;\n    /// Change binary type from \"blob\" to \"arraybuffer\"\n    websocket.binaryType = \"arraybuffer\";\n    websocket.onopen = (e) => {\n      this.logging(\"Websocket connected\");\n      if (typeof this.props.onOpen === \"function\") this.props.onOpen(e);\n    };\n\n    websocket.onerror = (e) => {\n      if (typeof this.props.onError === \"function\") this.props.onError(e);\n      if (e.code === \"ECONNREFUSED\") {\n        if (this.shouldReconnect) this.reconnect();\n      }\n    };\n\n    websocket.onmessage = (evt) => {\n      this.props.onMessage(evt.data);\n    };\n\n    this.shouldReconnect = this.props.reconnect;\n    websocket.onclose = (e) => {\n      this.logging(\n        `Websocket disconnected,the reason: ${e.reason},the code: ${e.code}`\n      );\n      if (typeof this.props.onClose === \"function\") this.props.onClose(e);\n      if (this.shouldReconnect && e.code !== 1000) this.reconnect();\n    };\n  }\n\n  reconnect() {\n    let time = this.generateInterval(this.state.attempts);\n    this.timeoutID = setTimeout(() => {\n      this.setState({ attempts: this.state.attempts + 1 });\n      this.setState({\n        ws: window.WebSocket\n          ? new window.WebSocket(this.props.url, this.props.protocol)\n          : new window.MozWebSocket(this.props.url, this.props.protocol)\n      });\n      this.setupWebsocket();\n    }, time);\n  }\n\n  componentDidMount() {\n    this.setupWebsocket();\n  }\n\n  componentWillUnmount() {\n    this.shouldReconnect = false;\n    clearTimeout(this.timeoutID);\n    let websocket = this.state.ws;\n    websocket.close();\n  }\n\n  sendMessage(message, callback) {\n    let websocket = this.state.ws;\n    if (websocket.readyState !== WebSocket.OPEN) {\n      console.log(\"websocket send in invalid state!\");\n      callback(-1);\n    }\n    websocket.send(message);\n    const timerid = setInterval(() => {\n      if (websocket.readyState !== WebSocket.OPEN) {\n        clearInterval(timerid);\n        callback(-1);\n      } else if (websocket.bufferedAmount === 0) {\n        clearInterval(timerid);\n        callback(0);\n      }\n    }, 20);\n  }\n\n  render() {\n    return <div></div>;\n  }\n}\n\nWebsocket.defaultProps = {\n  url: \"ws://localhost/ws_group_chat?username=9923456789\",\n  debug: true,\n  reconnect: true\n};\n\nWebsocket.propTypes = {\n  url: PropTypes.string.isRequired,\n  onMessage: PropTypes.func.isRequired,\n  onOpen: PropTypes.func,\n  onClose: PropTypes.func,\n  onError: PropTypes.func,\n  debug: PropTypes.bool,\n  reconnect: PropTypes.bool,\n  protocol: PropTypes.string,\n  reconnectIntervalInMilliSeconds: PropTypes.number\n};\n\nexport default Websocket;\n","import React from \"react\";\nimport Messages from \"./messages/messages\";\nimport InfoBar from \"./info_bar\";\nimport Input from \"./input\";\nimport http from \"../http_common\";\nimport { tlv_serialize_object, tlv_unserialize_object } from \"./tlv\";\nimport Websocket from \"./websocket\";\nimport { UserContext } from \"../user_context\";\nimport \"./chat.css\";\n\nconst ENDPOINT = \"wss://localhost/ws_group_chat\";\n\nfunction users_reducer(users, action) {\n  switch (action.type) {\n    case \"set\":\n      return action.users;\n    case \"online_users\": {\n      const cusers = [...users];\n      action.uids.forEach((uid) => {\n        cusers.forEach((user) => {\n          if (user.username === uid) {\n            user.online = true;\n          }\n        });\n      });\n      return cusers;\n    }\n    case \"on_state_change\": {\n      const cusers = [...users];\n      cusers.forEach((user) => {\n        if (user.username === action.change.uid) {\n          user.online = action.change.online;\n        }\n      });\n      return cusers;\n    }\n    default:\n      throw new Error(\"Unexpected action\");\n  }\n}\nconst Chat = (props) => {\n  const userCtx = React.useContext(UserContext);\n  const username = userCtx.user.username;\n  const ws = React.useRef(null);\n  const [classes, setClasses] = React.useState(null);\n  const [my, setMy] = React.useState(null);\n  const [users, dispatch] = React.useReducer(users_reducer, []);\n  const [messages, setMessages] = React.useState([]);\n  const [unreadMessages, setUnreadMessages] = React.useState(0);\n\n  const ws_onopen = (e) => {\n    console.log(`websocket onopen,event:${e}`);\n  };\n\n  const ws_onclose = (e) => {\n    console.log(`websocket onclose,code:${e.code}, reason:${e.reason}`);\n  };\n\n  const ws_onerror = (e) => {\n    console.log(`websocket onclose,code:${e.code}, reason:${e.reason}`);\n  };\n\n  const ws_onmessage = (data) => {\n    const wsmsg = tlv_unserialize_object(data);\n    for (const [key, value] of Object.entries(wsmsg)) {\n      if (key === \"on_message\") {\n        console.log(value);\n        setMessages([...messages, value]);\n      } else if (key === \"online_users\") {\n        dispatch({ type: \"online_users\", uids: value });\n      } else if (key === \"on_state_change\") {\n        dispatch({\n          type: \"on_state_change\",\n          change: value\n        });\n      } else if (key === \"unread_message_number\") {\n        setUnreadMessages(value);\n      } else {\n        console.log(`Unknown ws onmessage method:${key}`);\n      }\n    }\n  };\n\n  React.useEffect(() => {\n    if (username) {\n      /// Get class room information(classes/members/self)\n      http\n        .get(\"/sapling/get_class_chat_info\")\n        .then((response) => {\n          if (response.data.result === 0) {\n            /// Members\n            const members = response.data.members.map((user) => {\n              user.online = false;\n              return user;\n            });\n            dispatch({ type: \"set\", users: members });\n            /// Classes\n            setClasses(response.data.classes);\n            /// Self infomation\n            setMy(response.data.self);\n          } else {\n            console.log(`Server response error:${response.data.result}`);\n          }\n        })\n        .catch((e) => console.log(e.toJSON().message));\n    }\n  }, [username]);\n\n  const handleGetRemainMessages = (event) => {\n    if (unreadMessages === 0) return;\n    /// 获取未读的消息\n    let message = {\n      to: \"server\",\n      from: my.username,\n      type: \"text\",\n      content: \"get_unread_messages\"\n    };\n\n    /// Send to websocket server\n    let binMsg = tlv_serialize_object(message);\n    ws.current.sendMessage(binMsg, (result) => {\n      if (result !== 0) {\n        console.log(\"send get_unread_messages error!\");\n      } else {\n        setUnreadMessages((prev) => (prev < 10 ? 0 : prev - 10));\n      }\n    });\n  };\n\n  const sendMessage = (message, callback) => {\n    if (message) {\n      if (message.to.length === users.length) {\n        message.to = \"all\";\n      } else {\n        message.to = message.to.join();\n      }\n      /// Send to websocket server\n      let binMsg = tlv_serialize_object(message);\n      ws.current.sendMessage(binMsg, callback);\n      /// Reset message to display\n      message.to = my.username;\n      setMessages([...messages, message]);\n    }\n  };\n\n  return (\n    <div className=\"chat_outer_container\">\n      {username && (\n        <Websocket\n          ref={ws}\n          url={`${ENDPOINT}?username=${username}`}\n          onOpen={ws_onopen}\n          onMessage={ws_onmessage}\n          onClose={ws_onclose}\n          onError={ws_onerror}\n          reconnect={true}\n          debug={true}\n          protocol=\"chat\"\n        />\n      )}\n      {classes && my && (\n        <div className=\"chat_container\">\n          <InfoBar\n            classes={classes}\n            state={ws.current.readyState}\n            unReadMessages={unreadMessages}\n            handleNotifications={handleGetRemainMessages}\n          />\n          <Messages messages={messages} name={my.nick_name} />\n          <Input users={users} my={my} sendMessage={sendMessage} />\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Chat;\n","import React from \"react\";\nimport \"./test.css\";\nimport \"./barrage.css\";\nexport default function Test(props) {\n  return (\n    <div className=\"container\">\n      <div className=\"video__container\">\n        <video\n          id=\"myvideo\"\n          controls={true}\n          autoPlay={true}\n          poster=\"https://s3-us-west-2.amazonaws.com/s.cdpn.io/3/poster-img.jpg\"\n          preload=\"metadata\"\n        >\n          <source src=\"https://d.pr/f/On5R8M+\" type=\"video/webM\" />\n          <p>Your browser does not support the HTML5 Video Element</p>\n        </video>\n        <div>\n          <div className=\"track track-1\">\n            <span>柱子，你他娘了怎么不省点炮弹!</span>\n          </div>\n          <div className=\"track track-2\">\n            来，把老子的意大利炮抬上来，给柱子点个烟\n          </div>\n          <div className=\"track track-3\">小的们，吃唐僧肉啦</div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","// ==========================================================================\n// Type checking utils\n// ==========================================================================\n\nconst getConstructor = (input) =>\n  input !== null && typeof input !== \"undefined\" ? input.constructor : null;\nconst instanceOf = (input, constructor) =>\n  Boolean(input && constructor && input instanceof constructor);\nconst isNullOrUndefined = (input) =>\n  input === null || typeof input === \"undefined\";\nconst isObject = (input) => getConstructor(input) === Object;\nconst isNumber = (input) =>\n  getConstructor(input) === Number && !Number.isNaN(input);\nconst isString = (input) => getConstructor(input) === String;\nconst isBoolean = (input) => getConstructor(input) === Boolean;\nconst isFunction = (input) => getConstructor(input) === Function;\nconst isArray = (input) => Array.isArray(input);\nconst isWeakMap = (input) => instanceOf(input, WeakMap);\nconst isNodeList = (input) => instanceOf(input, NodeList);\nconst isTextNode = (input) => getConstructor(input) === Text;\nconst isEvent = (input) => instanceOf(input, Event);\nconst isKeyboardEvent = (input) => instanceOf(input, KeyboardEvent);\nconst isCue = (input) =>\n  instanceOf(input, window.TextTrackCue) || instanceOf(input, window.VTTCue);\nconst isTrack = (input) =>\n  instanceOf(input, TextTrack) ||\n  (!isNullOrUndefined(input) && isString(input.kind));\nconst isPromise = (input) =>\n  instanceOf(input, Promise) && isFunction(input.then);\n\nconst isElement = (input) =>\n  input !== null &&\n  typeof input === \"object\" &&\n  input.nodeType === 1 &&\n  typeof input.style === \"object\" &&\n  typeof input.ownerDocument === \"object\";\n\nconst isEmpty = (input) =>\n  isNullOrUndefined(input) ||\n  ((isString(input) || isArray(input) || isNodeList(input)) && !input.length) ||\n  (isObject(input) && !Object.keys(input).length);\n\nconst isUrl = (input) => {\n  // Accept a URL object\n  if (instanceOf(input, window.URL)) {\n    return true;\n  }\n\n  // Must be string from here\n  if (!isString(input)) {\n    return false;\n  }\n\n  // Add the protocol if required\n  let string = input;\n  if (!input.startsWith(\"http://\") || !input.startsWith(\"https://\")) {\n    string = `http://${input}`;\n  }\n\n  try {\n    return !isEmpty(new URL(string).hostname);\n  } catch (_) {\n    return false;\n  }\n};\n\nexport default {\n  nullOrUndefined: isNullOrUndefined,\n  object: isObject,\n  number: isNumber,\n  string: isString,\n  boolean: isBoolean,\n  function: isFunction,\n  array: isArray,\n  weakMap: isWeakMap,\n  nodeList: isNodeList,\n  element: isElement,\n  textNode: isTextNode,\n  event: isEvent,\n  keyboardEvent: isKeyboardEvent,\n  cue: isCue,\n  track: isTrack,\n  promise: isPromise,\n  url: isUrl,\n  empty: isEmpty\n};\n","// ==========================================================================\n// Element utils\n// ==========================================================================\n\nimport is from \"./is\";\nimport { extend } from \"./objects\";\n\n// Wrap an element\nexport function wrap(elements, wrapper) {\n  // Convert `elements` to an array, if necessary.\n  const targets = elements.length ? elements : [elements];\n\n  // Loops backwards to prevent having to clone the wrapper on the\n  // first element (see `child` below).\n  Array.from(targets)\n    .reverse()\n    .forEach((element, index) => {\n      const child = index > 0 ? wrapper.cloneNode(true) : wrapper;\n      // Cache the current parent and sibling.\n      const parent = element.parentNode;\n      const sibling = element.nextSibling;\n\n      // Wrap the element (is automatically removed from its current\n      // parent).\n      child.appendChild(element);\n\n      // If the element had a sibling, insert the wrapper before\n      // the sibling to maintain the HTML structure; otherwise, just\n      // append it to the parent.\n      if (sibling) {\n        parent.insertBefore(child, sibling);\n      } else {\n        parent.appendChild(child);\n      }\n    });\n}\n\n// Set attributes\nexport function setAttributes(element, attributes) {\n  if (!is.element(element) || is.empty(attributes)) {\n    return;\n  }\n\n  // Assume null and undefined attributes should be left out,\n  // Setting them would otherwise convert them to \"null\" and \"undefined\"\n  Object.entries(attributes)\n    .filter(([, value]) => !is.nullOrUndefined(value))\n    .forEach(([key, value]) => element.setAttribute(key, value));\n}\n\n// Create a DocumentFragment\nexport function createElement(type, attributes, text) {\n  // Create a new <element>\n  const element = document.createElement(type);\n\n  // Set all passed attributes\n  if (is.object(attributes)) {\n    setAttributes(element, attributes);\n  }\n\n  // Add text node\n  if (is.string(text)) {\n    element.innerText = text;\n  }\n\n  // Return built element\n  return element;\n}\n\n// Inaert an element after another\nexport function insertAfter(element, target) {\n  if (!is.element(element) || !is.element(target)) {\n    return;\n  }\n\n  target.parentNode.insertBefore(element, target.nextSibling);\n}\n\n// Insert a DocumentFragment\nexport function insertElement(type, parent, attributes, text) {\n  if (!is.element(parent)) {\n    return;\n  }\n\n  parent.appendChild(createElement(type, attributes, text));\n}\n\n// Remove element(s)\nexport function removeElement(element) {\n  if (is.nodeList(element) || is.array(element)) {\n    Array.from(element).forEach(removeElement);\n    return;\n  }\n\n  if (!is.element(element) || !is.element(element.parentNode)) {\n    return;\n  }\n\n  element.parentNode.removeChild(element);\n}\n\n// Remove all child elements\nexport function emptyElement(element) {\n  if (!is.element(element)) {\n    return;\n  }\n\n  let { length } = element.childNodes;\n\n  while (length > 0) {\n    element.removeChild(element.lastChild);\n    length -= 1;\n  }\n}\n\n// Replace element\nexport function replaceElement(newChild, oldChild) {\n  if (\n    !is.element(oldChild) ||\n    !is.element(oldChild.parentNode) ||\n    !is.element(newChild)\n  ) {\n    return null;\n  }\n\n  oldChild.parentNode.replaceChild(newChild, oldChild);\n\n  return newChild;\n}\n\n// Get an attribute object from a string selector\nexport function getAttributesFromSelector(sel, existingAttributes) {\n  // For example:\n  // '.test' to { class: 'test' }\n  // '#test' to { id: 'test' }\n  // '[data-test=\"test\"]' to { 'data-test': 'test' }\n\n  if (!is.string(sel) || is.empty(sel)) {\n    return {};\n  }\n\n  const attributes = {};\n  const existing = extend({}, existingAttributes);\n\n  sel.split(\",\").forEach((s) => {\n    // Remove whitespace\n    const selector = s.trim();\n    const className = selector.replace(\".\", \"\");\n    const stripped = selector.replace(/[[\\]]/g, \"\");\n    // Get the parts and value\n    const parts = stripped.split(\"=\");\n    const [key] = parts;\n    const value = parts.length > 1 ? parts[1].replace(/[\"']/g, \"\") : \"\";\n    // Get the first character\n    const start = selector.charAt(0);\n\n    switch (start) {\n      case \".\":\n        // Add to existing classname\n        if (is.string(existing.class)) {\n          attributes.class = `${existing.class} ${className}`;\n        } else {\n          attributes.class = className;\n        }\n        break;\n\n      case \"#\":\n        // ID selector\n        attributes.id = selector.replace(\"#\", \"\");\n        break;\n\n      case \"[\":\n        // Attribute selector\n        attributes[key] = value;\n\n        break;\n\n      default:\n        break;\n    }\n  });\n\n  return extend(existing, attributes);\n}\n\n// Toggle hidden\nexport function toggleHidden(element, hidden) {\n  if (!is.element(element)) {\n    return;\n  }\n\n  let hide = hidden;\n\n  if (!is.boolean(hide)) {\n    hide = !element.hidden;\n  }\n\n  // eslint-disable-next-line no-param-reassign\n  element.hidden = hide;\n}\n\n// Mirror Element.classList.toggle, with IE compatibility for \"force\" argument\nexport function toggleClass(element, className, force) {\n  if (is.nodeList(element)) {\n    return Array.from(element).map((e) => toggleClass(e, className, force));\n  }\n\n  if (is.element(element)) {\n    let method = \"toggle\";\n    if (typeof force !== \"undefined\") {\n      method = force ? \"add\" : \"remove\";\n    }\n\n    element.classList[method](className);\n    return element.classList.contains(className);\n  }\n\n  return false;\n}\n\n// Has class name\nexport function hasClass(element, className) {\n  return is.element(element) && element.classList.contains(className);\n}\n\n// Element matches selector\nexport function matches(element, selector) {\n  const { prototype } = Element;\n\n  function match() {\n    return Array.from(document.querySelectorAll(selector)).includes(this);\n  }\n\n  const method =\n    prototype.matches ||\n    prototype.webkitMatchesSelector ||\n    prototype.mozMatchesSelector ||\n    prototype.msMatchesSelector ||\n    match;\n\n  return method.call(element, selector);\n}\n\n// Closest ancestor element matching selector (also tests element itself)\nexport function closest(element, selector) {\n  const { prototype } = Element;\n\n  // https://developer.mozilla.org/en-US/docs/Web/API/Element/closest#Polyfill\n  function closestElement() {\n    let el = this;\n\n    do {\n      if (matches.matches(el, selector)) return el;\n      el = el.parentElement || el.parentNode;\n    } while (el !== null && el.nodeType === 1);\n    return null;\n  }\n\n  const method = prototype.closest || closestElement;\n\n  return method.call(element, selector);\n}\n\n// Find all elements\nexport function getElements(selector) {\n  return this.elements.container.querySelectorAll(selector);\n}\n\n// Find a single element\nexport function getElement(selector) {\n  return this.elements.container.querySelector(selector);\n}\n\n// Set focus and tab focus class\nexport function setFocus(element = null, tabFocus = false) {\n  if (!is.element(element)) {\n    return;\n  }\n\n  // Set regular focus\n  element.focus({ preventScroll: true });\n\n  // If we want to mimic keyboard focus via tab\n  if (tabFocus) {\n    toggleClass(element, this.config.classNames.tabFocus);\n  }\n}\n","// ==========================================================================\n// Browser sniffing\n// Unfortunately, due to mixed support, UA sniffing is required\n// ==========================================================================\nimport { createElement } from \"./elements\";\nimport is from \"./is\";\nconst USER_AGENT = window.navigator.userAgent || \"\";\nconst isEdge = () => /Edg/i.test(USER_AGENT);\nconst isChrome = () =>\n  !isEdge() && (/Chrome/i.test(USER_AGENT) || /CriOS/i.test(USER_AGENT));\nconst isAndroid = () => /Android/i.test(USER_AGENT);\nconst isTbsX5 = () => {\n  const matches = USER_AGENT.match(/tbs\\/(\\d+) /i);\n  if (!matches) return false;\n  return (matches[1] || \"\") > \"036849\";\n};\nconst isQQX5 = () => {\n  const matches = USER_AGENT.match(/MQQBrowser\\/([\\d+.]+) /i);\n  if (!matches) return false;\n  return (matches[1] || \"\") > 7.1;\n};\nconst isIPHONE = () => /(iPhone|iPod)/gi.test(navigator.platform);\nconst browser = {\n  isIE: Boolean(window.document.documentMode),\n  ieVersion: (function () {\n    const result = /MSIE\\s(\\d+)\\.\\d/.exec(USER_AGENT);\n    let version = result && parseFloat(result[1]);\n    if (\n      !version &&\n      /Trident\\/7.0/i.test(USER_AGENT) &&\n      /rv:11.0/.test(USER_AGENT)\n    ) {\n      // IE 11 has a different user agent string than other IE versions\n      version = 11.0;\n    }\n\n    return version;\n  })(),\n  isEdge: isEdge(),\n  isFirefox: /Firefox/i.test(USER_AGENT),\n  isChrome: isChrome(),\n  chromeVersion: (function () {\n    const match = USER_AGENT.match(/(Chrome|CriOS)\\/(\\d+)/);\n\n    if (match && match[2]) {\n      return parseFloat(match[2]);\n    }\n    return null;\n  })(),\n  isWebkit:\n    \"WebkitAppearance\" in document.documentElement.style &&\n    !/Edge/.test(navigator.userAgent),\n  isIPhone: isIPHONE(),\n  isIos:\n    (navigator.platform === \"MacIntel\" && navigator.maxTouchPoints > 1) ||\n    /(iPad|iPhone|iPod)/gi.test(navigator.platform),\n  iosVersion: (function () {\n    const match = window.navigator.userAgent.match(/OS (\\d+)_/i);\n    if (match && match[1]) {\n      return match[1];\n    }\n    return null;\n  })(),\n  isIPod: /iPod/i.test(window.navigator.userAgent),\n  isAndroid: isAndroid(),\n  androidVersion: (function () {\n    // This matches Android Major.Minor.Patch versions\n    // ANDROID_VERSION is Major.Minor as a Number, if Minor isn't available, then only Major is returned\n    const match = window.navigator.userAgent.match(\n      /Android (\\d+)(?:\\.(\\d+))?(?:\\.(\\d+))*/i\n    );\n\n    if (!match) {\n      return null;\n    }\n\n    const major = match[1] && parseFloat(match[1]);\n    const minor = match[2] && parseFloat(match[2]);\n\n    if (major && minor) {\n      return parseFloat(match[1] + \".\" + match[2]);\n    } else if (major) {\n      return major;\n    }\n    return null;\n  })(),\n  isSafari:\n    /Safari/i.test(USER_AGENT) && !isChrome() && !isAndroid() && !isEdge(),\n  isWindows: /Windows/i.test(USER_AGENT),\n  isX5: isTbsX5() || isQQX5(),\n  /** Judge supported media source extensions */\n  supportsMediaSource: (function () {\n    let mediaSource = window.self.MediaSource || window.self.WebKitMediaSource;\n    if (!mediaSource) {\n      return false;\n    }\n    let sourceBuffer =\n      window.self.SourceBuffer || window.self.WebKitSourceBuffer;\n    const isTypeSupported =\n      mediaSource &&\n      typeof mediaSource.isTypeSupported === \"function\" &&\n      mediaSource.isTypeSupported('video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"');\n    // if SourceBuffer is exposed ensure its API is valid\n    // safari and old version of Chrome doe not expose SourceBuffer globally so checking SourceBuffer.prototype is impossible\n    const sourceBufferValidAPI =\n      !sourceBuffer ||\n      (sourceBuffer.prototype &&\n        typeof sourceBuffer.prototype.appendBuffer === \"function\" &&\n        typeof sourceBuffer.prototype.remove === \"function\");\n    return !!isTypeSupported && !!sourceBufferValidAPI;\n  })(),\n  supportsNativeFullscreen: !!(\n    document.fullscreenEnabled ||\n    document.webkitFullscreenEnabled ||\n    document.mozFullScreenEnabled ||\n    document.msFullscreenEnabled\n  ),\n  supportsShadowDOM: !!HTMLElement.prototype.attachShadow,\n  supportsWASM: (function () {\n    try {\n      if (\n        typeof WebAssembly === \"object\" &&\n        typeof WebAssembly.instantiate === \"function\"\n      ) {\n        const module = new WebAssembly.Module(\n          Uint8Array.of(0x0, 0x61, 0x73, 0x6d, 0x01, 0x00, 0x00, 0x00)\n        );\n        if (module instanceof WebAssembly.Module)\n          return (\n            new WebAssembly.Instance(module) instanceof WebAssembly.Instance\n          );\n      }\n    } catch (e) {}\n    return false;\n  })(),\n  // Picture-in-picture support\n  // Safari & Chrome only currently\n  pip: (() => {\n    if (isIPHONE()) {\n      return false;\n    }\n\n    // Safari\n    // https://developer.apple.com/documentation/webkitjs/adding_picture_in_picture_to_your_safari_media_controls\n    if (is.function(createElement(\"video\").webkitSetPresentationMode)) {\n      return true;\n    }\n\n    // Chrome\n    // https://developers.google.com/web/updates/2018/10/watch-video-using-picture-in-picture\n    if (\n      document.pictureInPictureEnabled &&\n      !createElement(\"video\").disablePictureInPicture\n    ) {\n      return true;\n    }\n\n    return false;\n  })(),\n  // Airplay support\n  // Safari only currently\n  airplay: is.function(window.WebKitPlaybackTargetAvailabilityEvent)\n};\n\nexport default browser;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FaVideo, FaVideoSlash, FaServer } from \"react-icons/fa\";\nimport { genPlayUri } from \"./utils\";\nimport \"./camera_list.css\";\nexport default function CameraList(props) {\n  const { camlist, onPlayUri } = props;\n  const [cameras, setCameras] = React.useState(null);\n  const [groups, setGroups] = React.useState(null);\n  const [currentCamera, setCurrentCamera] = React.useState(null);\n\n  const getCurrentPlayCam = (clist) => {\n    if (clist.cameras) {\n      for (const cam of clist.cameras) {\n        if (cam.selected) return cam;\n      }\n    }\n    if (clist.groups) {\n      for (const group of clist.groups) {\n        for (const cam of group.cameras) {\n          if (cam.selected) return cam;\n        }\n      }\n    }\n    return null;\n  };\n\n  React.useEffect(() => {\n    /** 给每一个camera 增加属性 'selected' 并返回默认选择播放的url及是否用主码流*/\n    const fixCameraList = (clist) => {\n      // 预处理 camlist\n      let obj = { playuri: \"\", is_main_stream: true };\n      if (clist.cameras) {\n        let dcams = clist.cameras.map((cam) => {\n          if (cam.status === 1 && !obj.playuri) {\n            cam[\"selected\"] = true;\n            obj.playuri = genPlayUri(cam.oid);\n            obj.is_main_stream = cam.is_main_stream;\n            setCurrentCamera(cam);\n          } else {\n            cam[\"selected\"] = false;\n          }\n          return cam;\n        });\n        clist.cameras = dcams;\n      }\n      if (clist.groups) {\n        let cgroups = clist.groups.map((group) => {\n          group.selected = false;\n          group.show = false;\n          group.cameras.forEach((cam, index, theArray) => {\n            theArray[index].group = group;\n            if (cam.status === 1 && !obj.playuri) {\n              theArray[index].selected = true;\n              group.selected = true;\n              obj.playuri = genPlayUri(cam.oid);\n              obj.is_main_stream = cam.is_main_stream;\n              setCurrentCamera(theArray[index]);\n            } else {\n              theArray[index].selected = false;\n            }\n          });\n          return group;\n        });\n        clist.groups = cgroups;\n      }\n      return obj;\n    };\n\n    if (camlist) {\n      let clist = camlist;\n      let robj = null;\n      if (!clist.fixed) {\n        robj = fixCameraList(clist);\n        clist.fixed = true;\n      } else {\n        setCurrentCamera(getCurrentPlayCam(clist));\n      }\n      if (clist.groups && clist.groups.length === 1) {\n        /// Merge to cameras\n        let cams = clist.cameras || [];\n        let newcams = cams.concat(clist.groups[0].cameras);\n        setCameras(newcams);\n      } else {\n        if (clist.groups) setGroups(clist.groups);\n        if (clist.cameras) setCameras(clist.cameras);\n      }\n      if (robj && robj.playuri) {\n        onPlayUri(robj.playuri, robj.is_main_stream);\n      }\n    }\n  }, [camlist, onPlayUri]);\n\n  /** 用户点击摄像头 */\n  const onClickCamera = (cam) => {\n    console.log(`Click cam:${cam.oid}`);\n    if (currentCamera) {\n      currentCamera.selected = false;\n      if (currentCamera.group) {\n        currentCamera.group.selected = false;\n      }\n    }\n\n    cam.selected = true;\n    if (cam.group) {\n      cam.group.selected = true;\n      cam.group.show = false;\n    }\n\n    setCurrentCamera(cam);\n    /// Update container\n    if (cameras) setCameras([...cameras]);\n    if (groups) setGroups([...groups]);\n    onPlayUri(genPlayUri(cam.oid), cam.is_main_stream);\n  };\n\n  /** 用户点击group */\n  const onClickGroup = (group) => {\n    group.show = !group.show;\n    setGroups([...groups]);\n  };\n\n  const genCameraList = () =>\n    cameras.map((cam) => (\n      <div key={cam.oid} className=\"camera_container\">\n        {cam.status === 1 ? (\n          <span\n            className={\n              cam.selected ? \"largeicon enable selected\" : \"largeicon enable\"\n            }\n            onClick={(event) => onClickCamera(cam)}\n          >\n            <FaVideo />\n          </span>\n        ) : (\n          <span className=\"largeicon\">\n            <FaVideoSlash />\n          </span>\n        )}\n        <p>{cam.name}</p>\n      </div>\n    ));\n\n  const genSubCamList = (clist) =>\n    clist.map((cam) =>\n      cam.status === 1 ? (\n        <div\n          key={cam.oid}\n          className={\n            cam.selected\n              ? \"camera_row_container enable selected\"\n              : \"camera_row_container enable\"\n          }\n          onClick={(event) => onClickCamera(cam)}\n        >\n          <span className=\"smallicon\">\n            <FaVideo />\n          </span>\n          <p>{cam.name}</p>\n        </div>\n      ) : (\n        <div className=\"camera_row_container\">\n          <span className=\"smallicon\">\n            <FaVideo />\n          </span>\n          <p>{cam.name}</p>\n        </div>\n      )\n    );\n\n  const genGroupList = () =>\n    groups.map((group) => (\n      <div key={group.gid} className=\"camera_container\">\n        <span\n          className={\n            group.selected ? \"largeicon enable selected\" : \"largeicon enable\"\n          }\n          onClick={(event) => onClickGroup(group)}\n        >\n          <FaServer />\n        </span>\n        <div\n          className={\n            group.show ? \"cameras_sub_container show\" : \"cameras_sub_container\"\n          }\n        >\n          {genSubCamList(group.cameras)}\n        </div>\n        <p>{group.name}</p>\n      </div>\n    ));\n\n  return (\n    <div className={groups ? \"devlist_container\" : \"devlist_container scrollx\"}>\n      {cameras && genCameraList()}\n      {groups && genGroupList()}\n    </div>\n  );\n}\n\nCameraList.propTypes = {\n  camlist: PropTypes.object.isRequired,\n  onPlayUri: PropTypes.func.isRequired\n};\n\nCameraList.defaultProps = {\n  camlist: {\n    cameras: [],\n    groups: [\n      {\n        gid: \"3214124121324\",\n        name: \"北碚紫荆花幼儿园\",\n        cameras: [\n          { oid: \"142313441234123\", name: \"中一班\", status: 1 },\n          { oid: \"142313441141231\", name: \"中二班\", status: 1 },\n          { oid: \"142313441141232\", name: \"中二班\", status: 1 },\n          { oid: \"142313441141233\", name: \"中二班\", status: 1 },\n          { oid: \"142313441141234\", name: \"中二班\", status: 1 },\n          { oid: \"142313441141235\", name: \"中二班\", status: 1 },\n          { oid: \"142313441141236\", name: \"中二班\", status: 1 }\n        ]\n      }\n    ]\n  },\n  onPlayUri: () => {}\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport ScrollToBottom from \"react-scroll-to-bottom\";\nimport Avatar from \"./avatar\";\nimport ReactEmoji from \"react-emoji\";\nimport { parseFrom } from \"./utils\";\nimport \"./jabber.css\";\nexport default function Jabber(props) {\n  const { messages } = props;\n  return (\n    <ScrollToBottom className=\"messagesContainer\">\n      {messages &&\n        messages.map((message, index) => {\n          let ufrom = parseFrom(message.from);\n          return (\n            <div key={index} className=\"jabberContainer\">\n              <Avatar\n                image={\n                  ufrom.avatar\n                    ? `http://192.168.3.200/imgs/${ufrom.username}.${ufrom.avatar}`\n                    : \"\"\n                }\n                name={ufrom.name}\n                size={24}\n                position=\"left\"\n              />\n              <span className=\"title\">\n                {new Date(Number(message.ts)).toLocaleTimeString(\"en-US\", {\n                  hour12: false\n                })}\n              </span>\n              <span className=\"title\">{ufrom.name}</span>\n              <span>{ReactEmoji.emojify(message.content)}</span>\n            </div>\n          );\n        })}\n    </ScrollToBottom>\n  );\n}\n\nJabber.propTypes = {\n  messages: PropTypes.array.isRequired\n};\n\nJabber.defaultProps = {\n  messages: [\n    {\n      from: \"系统消息:jpg@admin\",\n      content: \"铴好的中华人民共和国\",\n      ts: Date.now()\n    }\n  ]\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport ReactEmoji from \"react-emoji\";\nimport { parseFrom } from \"./utils\";\nimport \"./barrage.css\";\n\nconst tracks_reducer = (tracks, action) => {\n  switch (action.type) {\n    case \"set_free_tracks\": {\n      let l = action.message.content.length;\n      if (l < 10) {\n        for (let i = 4; i >= 0; i--) {\n          if (!tracks[i].working) {\n            console.log(`found free track:${i}`);\n            action.result = true;\n            tracks[i].working = true;\n            tracks[i].startTs = window.performance.now();\n            tracks[i].message = action.message;\n            return [...tracks];\n          }\n        }\n      } else {\n        for (let i = 0; i <= 4; i++) {\n          if (!tracks[i].working) {\n            console.log(`found free track:${i}`);\n            action.result = true;\n            tracks[i].working = true;\n            tracks[i].startTs = window.performance.now();\n            tracks[i].message = action.message;\n            return [...tracks];\n          }\n        }\n      }\n      console.log(\"Not free track!\");\n      action.result = false;\n      return tracks;\n    }\n    case \"check_state\": {\n      let is_changed = false;\n      for (const track of tracks) {\n        if (track.working) {\n          if (\n            window.performance.now() - track.startTs >\n            track.interval * 1000\n          ) {\n            /** Track 工作已经完成 */\n            is_changed = true;\n            track.working = false;\n          }\n        }\n      }\n      if (is_changed) {\n        action.hasFreeTracks = true;\n        return [...tracks];\n      } else {\n        action.hasFreeTracks = false;\n        return tracks;\n      }\n    }\n    default:\n      throw new Error(`Unexpected action:${action.type}`);\n  }\n};\nexport default function Barrage(props) {\n  const { message } = props;\n  const refMessages = React.useRef([]);\n  const [tracksState, dispatchTracksState] = React.useReducer(tracks_reducer, [\n    { index: 0, interval: 10, working: false, startTs: 0, message: null },\n    { index: 1, interval: 9, working: false, startTs: 0, message: null },\n    { index: 2, interval: 8, working: false, startTs: 0, message: null },\n    { index: 3, interval: 7, working: false, startTs: 0, message: null },\n    { index: 4, interval: 6, working: false, startTs: 0, message: null }\n  ]);\n\n  React.useEffect(() => {\n    if (message) {\n      console.log(message);\n      let params = { type: \"set_free_tracks\", message: message };\n      dispatchTracksState(params);\n      if (!params.result) {\n        /** 当没有空闲的track时，将消息存入队列以后处理 */\n        refMessages.current.push(message);\n      }\n    }\n  }, [message]);\n\n  React.useEffect(() => {\n    let timerid = setInterval(() => {\n      let actionState = { type: \"check_state\" };\n      dispatchTracksState(actionState);\n      if (actionState.hasFreeTracks) {\n        let msg = null;\n        do {\n          msg = refMessages.current.shift();\n          if (msg) {\n            let params = {\n              type: \"set_free_tracks\",\n              message: msg\n            };\n            dispatchTracksState(params);\n          }\n        } while (msg);\n      }\n    }, 1000);\n    return () => {\n      console.log(\"destory timer\");\n      clearInterval(timerid);\n    };\n  }, []);\n\n  const genBarage = () => {\n    return tracksState.map((track, index) => {\n      if (track.working) {\n        let ufrom = parseFrom(track.message.from);\n        return (\n          <div key={index} className={`track track-${index}`}>\n            <span className=\"title\">{`${ufrom.name}:`}</span>\n            <span>{ReactEmoji.emojify(track.message.content)}</span>\n          </div>\n        );\n      } else {\n        return null;\n      }\n    });\n  };\n\n  return <div>{genBarage()}</div>;\n}\n\nBarrage.propTypes = {\n  message: PropTypes.object.isRequired\n};\n\nBarrage.defaultProps = {\n  message: {\n    from: \"系统消息:jpg@admin\",\n    content: \"铴好的中华人民共和国:)\",\n    ts: Date.now()\n  }\n};\n","import React from \"react\";\n// custom hook for getting previous value\nfunction usePrevious(value) {\n  const ref = React.useRef();\n  React.useEffect(() => {\n    ref.current = value;\n  });\n  return ref.current;\n}\n\n/**\n * Hook that clicks outside of the passed ref\n */\nfunction useOutsideClick(ref, onOutsideClick) {\n  React.useEffect(() => {\n    /**\n     * Dispatch click event if clicked on outside of element\n     */\n    function handleClickOutside(event) {\n      if (ref.current && !ref.current.contains(event.target)) {\n        onOutsideClick(event);\n      }\n    }\n    // Bind the event listener\n    document.addEventListener(\"mousedown\", handleClickOutside);\n    return () => {\n      // Unbind the event listener on clean up\n      document.removeEventListener(\"mousedown\", handleClickOutside);\n    };\n  }, [ref, onOutsideClick]);\n}\n\nexport { usePrevious, useOutsideClick };\n","import React, { createContext, useState } from \"react\";\nimport { CSSTransition } from \"react-transition-group\";\nimport \"./snackbar.css\";\n\n// Snackbar default values\nexport const defaultPosition = \"bottom-center\";\nexport const defaultDuration = 5000;\nexport const defaultInterval = 250;\nexport const positions = [\n  \"top-left\",\n  \"top-center\",\n  \"top-right\",\n  \"bottom-left\",\n  \"bottom-center\",\n  \"bottom-right\"\n];\n\n// Context used by the hook useSnackbar() and HoC withSnackbar()\nexport const SnackbarContext = createContext(null);\n\nexport default function Snackbar({ children }) {\n  // Current open state\n  const [open, setOpen] = useState(false);\n  // Current timeout ID\n  const [timeoutId, setTimeoutId] = useState(null);\n  // Snackbar's text\n  const [text, setText] = useState(\"\");\n  // Snackbar's duration\n  const [duration, setDuration] = useState(defaultDuration);\n  // Snackbar's position\n  const [position, setPosition] = useState(defaultPosition);\n  // Custom styles for the snackbar itself\n  const [customStyles, setCustomStyles] = useState({});\n  // Custom styles for the close button\n  const [closeCustomStyles, setCloseCustomStyles] = useState({});\n\n  const triggerSnackbar = (text, duration, position, style, closeStyle) => {\n    setText(text);\n    setDuration(duration);\n    setPosition(position);\n    setCustomStyles(style);\n    setCloseCustomStyles(closeStyle);\n    setOpen(true);\n  };\n\n  // Manages all the snackbar's opening process\n  const openSnackbar = (text, duration, position, style, closeStyle) => {\n    // Closes the snackbar if it is already open\n    if (open === true) {\n      setOpen(false);\n      setTimeout(() => {\n        triggerSnackbar(text, duration, position, style, closeStyle);\n      }, defaultInterval);\n    } else {\n      triggerSnackbar(text, duration, position, style, closeStyle);\n    }\n  };\n\n  // Closes the snackbar just by setting the \"open\" state to false\n  const closeSnackbar = () => {\n    setOpen(false);\n  };\n\n  // Returns the Provider that must wrap the application\n  return (\n    <SnackbarContext.Provider value={{ openSnackbar, closeSnackbar }}>\n      {children}\n\n      {/* Renders Snackbar on the end of the page */}\n      <CSSTransition\n        in={open}\n        timeout={150}\n        mountOnEnter\n        unmountOnExit\n        // Sets timeout to close the snackbar\n        onEnter={() => {\n          clearTimeout(timeoutId);\n          setTimeoutId(setTimeout(() => setOpen(false), duration));\n        }}\n        // Sets custom classNames based on \"position\"\n        className={`snackbar-wrapper snackbar-wrapper-${position}`}\n        classNames={{\n          enter: `snackbar-enter snackbar-enter-${position}`,\n          enterActive: `snackbar-enter-active snackbar-enter-active-${position}`,\n          exitActive: `snackbar-exit-active snackbar-exit-active-${position}`\n        }}\n      >\n        {/* This div will be rendered with CSSTransition classNames */}\n        <div>\n          <div className=\"snackbar\" style={customStyles}>\n            {/* Snackbar's text */}\n            <div className=\"snackbar__text\">{text}</div>\n\n            {/* Snackbar's close button */}\n            <button\n              onClick={closeSnackbar}\n              className=\"snackbar__close\"\n              style={closeCustomStyles}\n            >\n              <CloseIcon />\n            </button>\n          </div>\n        </div>\n      </CSSTransition>\n    </SnackbarContext.Provider>\n  );\n}\n\n// CloseIcon SVG is styled with font properties\nconst CloseIcon = () => (\n  <svg width=\"1em\" height=\"1em\" viewBox=\"0 0 12 12\">\n    <path\n      fill=\"currentColor\"\n      d=\"M11.73 1.58L7.31 6l4.42 4.42-1.06 1.06-4.42-4.42-4.42 4.42-1.06-1.06L5.19 6 .77 1.58 1.83.52l4.42 4.42L10.67.52z\"\n      fillRule=\"evenodd\"\n    />\n  </svg>\n);\n","import { useContext } from \"react\";\nimport {\n  SnackbarContext,\n  defaultDuration,\n  defaultPosition,\n  positions\n} from \"./snackbar\";\n\n// Custom hook to trigger the snackbar on function components\nexport const useSnackbar = ({\n  position = defaultPosition,\n  style = {},\n  closeStyle = {}\n} = {}) => {\n  const { openSnackbar, closeSnackbar } = useContext(SnackbarContext);\n\n  // If no correct position is passed, 'bottom-center' is set\n  if (!positions.includes(position)) {\n    position = defaultPosition;\n  }\n\n  function open(text = \"\", duration = defaultDuration) {\n    openSnackbar(text, duration, position, style, closeStyle);\n  }\n\n  // Returns methods in hooks array way\n  return [open, closeSnackbar];\n};\n","const BarrageIconOn = () => (\n  <div style={{ marginLeft: \"2px\" }}>\n    <svg\n      t=\"1639358405657\"\n      className=\"icon\"\n      viewBox=\"0 0 1024 1024\"\n      version=\"1.1\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      p-id=\"4466\"\n      fill=\"white\"\n      width=\"28\"\n      height=\"28\"\n    >\n      <defs>\n        <style type=\"text/css\"></style>\n      </defs>\n      <path\n        d=\"M511.5904 93.184C280.8832 93.184 92.16 281.9072 92.16 512.6144s188.7232 419.4304 419.4304 419.4304 419.4304-188.7232 419.4304-419.4304S747.52 93.184 511.5904 93.184L511.5904 93.184zM511.5904 879.616c-204.4928 0-367.0016-162.5088-367.0016-367.0016s162.5088-367.0016 367.0016-367.0016S878.592 308.1216 878.592 512.6144 716.0832 879.616 511.5904 879.616L511.5904 879.616z\"\n        p-id=\"4467\"\n      ></path>\n      <path\n        d=\"M359.5264 523.0592 443.392 523.0592c0 68.1984 0 115.3024-5.2224 136.2944-5.2224 20.992-26.2144 36.6592-62.8736 36.6592-10.4448 0-20.992 0-26.2144 0l-5.2224-26.2144c10.4448 0 20.992 0 31.4368 0 26.2144 0 36.6592-5.2224 41.984-20.992 5.2224-15.7696 5.2224-47.2064 5.2224-94.4128l-94.4128 0 10.4448-115.3024 73.4208 0 0-68.1984-78.6432 0 0-26.2144L443.392 344.6784l0 115.3024-78.6432 0L359.5264 523.0592 359.5264 523.0592zM595.456 391.9872c10.4448-20.992 20.992-41.984 31.4368-68.1984l26.2144 10.4448c-10.4448 20.992-20.992 41.984-31.4368 57.6512l52.4288 0 0 162.5088-83.8656 0 0 36.6592 104.8576 0L695.0912 617.472 590.2336 617.472l0 78.6432-31.4368 0L558.7968 617.472l-99.6352 0 0-20.992 99.6352 0 0-41.984-83.8656 0L474.9312 391.9872 595.456 391.9872 595.456 391.9872zM553.5744 381.5424l-20.992 10.4448c-10.4448-20.992-20.992-41.984-36.6592-57.6512l26.2144-10.4448C537.8048 344.8832 548.2496 360.5504 553.5744 381.5424L553.5744 381.5424zM558.7968 465.408l0-47.2064-57.6512 0 0 47.2064L558.7968 465.408 558.7968 465.408zM558.7968 486.4l-57.6512 0 0 41.984 57.6512 0L558.7968 486.4 558.7968 486.4zM590.2336 465.408l57.6512 0 0-47.2064-57.6512 0L590.2336 465.408 590.2336 465.408zM647.8848 486.4l-57.6512 0 0 41.984 57.6512 0L647.8848 486.4 647.8848 486.4z\"\n        p-id=\"4468\"\n      ></path>\n    </svg>\n  </div>\n);\n\nconst BarrageIconOff = () => (\n  <div style={{ marginLeft: \"2px\" }}>\n    <svg\n      t=\"1639358446201\"\n      className=\"icon\"\n      viewBox=\"0 0 1024 1024\"\n      version=\"1.1\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      p-id=\"4608\"\n      fill=\"white\"\n      width=\"28\"\n      height=\"28\"\n    >\n      <defs>\n        <style type=\"text/css\"></style>\n      </defs>\n      <path\n        d=\"M361.0624 522.24l83.8656 0c0 68.1984 0 115.3024-5.2224 136.2944-5.2224 20.992-26.2144 36.6592-62.8736 36.6592-10.4448 0-20.992 0-26.2144 0l-5.2224-26.2144c10.4448 0 20.992 0 31.4368 0 26.2144 0 36.6592-5.2224 41.984-20.992 5.2224-15.7696 5.2224-47.2064 5.2224-94.4128l-94.4128 0L340.1728 438.272l73.4208 0 0-68.1984L334.848 370.0736l0-26.2144 110.08 0 0 115.3024-78.6432 0L361.0624 522.24 361.0624 522.24zM596.992 391.168c10.4448-20.992 20.992-41.984 31.4368-68.1984l26.2144 10.4448c-10.4448 20.992-20.992 41.984-31.4368 57.6512l52.4288 0 0 162.5088-83.8656 0 0 36.6592 104.8576 0 0 26.2144L591.7696 616.448l0 78.6432-31.4368 0 0-78.6432-99.6352 0 0-20.992 99.6352 0 0-41.984-83.8656 0L476.4672 391.168 596.992 391.168 596.992 391.168zM555.1104 380.6208 534.1184 391.168c-10.4448-20.992-20.992-41.984-36.6592-57.6512l26.2144-10.4448C539.3408 343.9616 549.888 359.6288 555.1104 380.6208L555.1104 380.6208zM560.3328 464.4864l0-47.2064-57.6512 0 0 47.2064L560.3328 464.4864 560.3328 464.4864zM560.3328 485.4784l-57.6512 0 0 41.984 57.6512 0L560.3328 485.4784 560.3328 485.4784zM591.7696 464.4864l57.6512 0 0-47.2064-57.6512 0L591.7696 464.4864 591.7696 464.4864zM649.4208 485.4784l-57.6512 0 0 41.984 57.6512 0L649.4208 485.4784 649.4208 485.4784z\"\n        p-id=\"4609\"\n      ></path>\n      <path\n        d=\"M513.1264 89.7024c-230.7072 0-419.4304 188.7232-419.4304 419.4304s188.7232 419.4304 419.4304 419.4304 419.4304-188.7232 419.4304-419.4304S749.056 89.7024 513.1264 89.7024zM880.128 509.1328c0 92.7744-33.3824 176.8448-88.9856 241.0496L272.0768 231.1168c64.2048-55.6032 148.2752-88.9856 241.0496-88.9856C717.6192 142.1312 880.128 304.64 880.128 509.1328zM146.1248 509.1328c0-92.7744 33.3824-176.8448 88.9856-241.0496l519.0656 519.0656c-64.2048 55.6032-148.2752 88.9856-241.0496 88.9856C308.6336 876.1344 146.1248 713.5232 146.1248 509.1328z\"\n        p-id=\"4610\"\n      ></path>\n    </svg>\n  </div>\n);\nexport { BarrageIconOn, BarrageIconOff };\n","import Hls from \"hls.js\";\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\nimport browser from \"../utils/browser\";\nimport is from \"../utils/is\";\nimport CameraList from \"./camera_list\";\nimport Jabber from \"./jabber\";\nimport Barrage from \"./barrage\";\nimport { useOutsideClick } from \"../utils/hook\";\nimport { useSnackbar } from \"./use_snackbar\";\nimport { BarrageIconOn, BarrageIconOff } from \"./barrage_icon\";\nimport {\n  FaPlay,\n  FaPause,\n  FaExpand,\n  FaExpandAlt,\n  FaVolumeUp,\n  FaVolumeMute,\n  FaExternalLinkAlt,\n  FaBars,\n  FaTelegramPlane,\n  FaOsi\n} from \"react-icons/fa\";\nimport \"./hlsplayer.css\";\n/* eslint-disable no-console */\nconst screen = window.screen;\nscreen.lockOrientationUniversal = (mode) =>\n  (screen.orientation &&\n    screen.orientation.lock(mode).then(\n      () => {},\n      (err) => console.log(err)\n    )) ||\n  (screen.mozLockOrientation && screen.mozLockOrientation(mode)) ||\n  (screen.msLockOrientation && screen.msLockOrientation(mode));\n\nconst angle = () => {\n  // iOS\n  if (typeof window.orientation === \"number\") {\n    return window.orientation;\n  }\n  // Android\n  if (screen && screen.orientation && screen.orientation.angle) {\n    return window.orientation;\n  }\n  console.log(\"angle unknown\");\n  return 0;\n};\n\n// Get the prefix for fullscreen api\nfunction get_fullscreen_prefix() {\n  // No prefix\n  if (is.function(document.exitFullscreen)) {\n    return \"\";\n  }\n\n  // Check for fullscreen support by vendor prefix\n  let value = \"\";\n  const prefixes = [\"webkit\", \"moz\", \"ms\"];\n\n  prefixes.some((pre) => {\n    if (\n      is.function(document[`${pre}ExitFullscreen`]) ||\n      is.function(document[`${pre}CancelFullScreen`])\n    ) {\n      value = pre;\n      return true;\n    }\n\n    return false;\n  });\n\n  return value;\n}\n/// Get the name for fullscreen api\nfunction get_fullscreen_name(prefix) {\n  return prefix === \"moz\" ? \"FullScreen\" : \"Fullscreen\";\n}\n\n/**\n * [fn.is_fullscreen] 检测是否全屏状态\n */\nfunction is_state_fullscreen() {\n  return !!(\n    document.fullscreenElement ||\n    document.msFullscreenElement ||\n    document.mozFullScreenElement ||\n    document.webkitFullscreenElement\n  );\n}\n\nfunction has_audio(media) {\n  // Get audio tracks\n  return (\n    Boolean(media.mozHasAudio) ||\n    Boolean(media.webkitAudioDecodedByteCount) ||\n    Boolean(media.audioTracks && media.audioTracks.length)\n  );\n}\n\nfunction get_duration(media) {\n  // Media duration can be NaN or Infinity before the media has loaded\n  const realDuration = (media || {}).duration;\n  const duration =\n    !is.number(realDuration) || realDuration === Infinity ? 0 : realDuration;\n\n  // If config duration is funky, use regular duration\n  return duration;\n}\n\nexport default function HLSPlayer(props) {\n  const PLAYER_STATE_PAUSE = 0;\n  const PLAYER_STATE_PLAY = 1;\n  const PLAYER_STATE_PLAYING = 2;\n  const PLAYER_STATE_ABORT = 3;\n  const PLAYER_STATE_ERROR = 4;\n  const PLAYER_STATE_WAITING = 5;\n  const PLAYER_STATE_ENDED = 6;\n  const PLAYER_STATE_SUSPEND = 7;\n  const PLAYER_STATE_STALLED = 8;\n  const PLAYER_STATE_EMPTIED = 9;\n  const {\n    url,\n    controls,\n    autoplay,\n    hlsConfig,\n    poster,\n    videoProps,\n    cameras,\n    messages,\n    onRefreshCamlist,\n    onSendMessage,\n    onPlayChange\n  } = props;\n  const [openSnackbar] = useSnackbar();\n  const [dimensions, setDimensions] = React.useState({ width: 0, height: 0 });\n  const [checkMpd, setCheckMpd] = React.useState(\"\");\n  const [streamUri, setStreamUri] = React.useState(\"\");\n  const [seekval, setSeekval] = React.useState(0);\n  const [duration, setDuration] = React.useState(NaN);\n  const [hasAudio, setHasAudio] = React.useState(false);\n  const [muted, setMuted] = React.useState(false);\n  const [volume, setVolume] = React.useState(1.0);\n  const [state, setState] = React.useState(PLAYER_STATE_PAUSE);\n  const [loading, setLoading] = React.useState(false);\n  const [isFullScreen, setIsFullScreen] = React.useState(false);\n  const [isBarrage, setIsBarrage] = React.useState(true);\n  const [scrollPosition, setScrollPosition] = React.useState({ x: 0, y: 0 });\n  const [cleanupViewport, setCleanupViewport] = React.useState(false);\n  const [message, setMessage] = React.useState(\"\");\n  const [barrageMessage, setBarrageMessage] = React.useState(null);\n  const refVidContainer = React.useRef();\n  const refHls = React.useRef(null);\n  const refVideo = React.useRef(null);\n  const refControls = React.useRef(null);\n  const refFsMenuBut = React.useRef(null);\n  const refFsMenu = React.useRef(null);\n  useOutsideClick(refFsMenu, (event) => {\n    if (refFsMenuBut.current && !refFsMenuBut.current.contains(event.target)) {\n      refFsMenu.current.classList.remove(\"show\");\n    }\n  });\n\n  /** 尝试播放媒体 */\n  const tryPlaying = React.useCallback((hasaudio) => {\n    try {\n      refVideo.current.play();\n    } catch (error) {\n      if (error.name === \"NotAllowedError\") {\n        if (hasaudio && !refVideo.current.muted) {\n          refVideo.current.muted = true;\n          tryPlaying();\n        } else {\n          /** 需要用户交互式播放 */\n          setLoading(false);\n          refControls.current.classList.toggle(\"show\");\n        }\n      } else {\n        setLoading(false);\n        refControls.current.classList.toggle(\"show\");\n      }\n    }\n  }, []);\n\n  /** MSE load and playing */\n  const msePlay = React.useCallback(\n    (mutual) => {\n      setLoading(true);\n      refHls.current = new Hls(hlsConfig);\n      refHls.current.attachMedia(refVideo.current);\n      refHls.current.on(Hls.Events.MEDIA_ATTACHED, () => {\n        console.log(\"video and hls.js are now bound together !\");\n        refHls.current.loadSource(streamUri);\n        refHls.current.on(Hls.Events.MANIFEST_PARSED, () => {\n          setDuration(get_duration(refVideo.current));\n          let hasaudio = has_audio(refVideo.current);\n          setHasAudio(hasaudio);\n\n          if (autoplay || mutual) {\n            tryPlaying(hasaudio);\n            console.log(`duration:${refVideo.current.duration}`);\n          }\n        });\n      });\n      refHls.current.on(Hls.Events.ERROR, function (event, data) {\n        setLoading(false);\n        if (data.fatal) {\n          if (data.type === Hls.ErrorTypes.MEDIA_ERROR) {\n            console.log(\"media error encountered, try to recover\");\n            refHls.current.recoverMediaError();\n          } else {\n            console.log(\"Error,type:\" + data.type + \" details:\" + data.details);\n            refHls.current.stopLoad();\n            refHls.current.detachMedia();\n            refHls.destory();\n            setState(PLAYER_STATE_ERROR);\n            ///refHls.current.detachMedia();\n            ///refHls.current.destroy();\n            /// Handling hls.js error\n            if (data.type === Hls.ErrorTypes.NETWORK_ERROR) {\n              let details = data.details;\n              if (\n                details === Hls.ErrorDetails.MANIFEST_LOAD_ERROR ||\n                details === Hls.ErrorDetails.LEVEL_LOAD_ERROR ||\n                details === Hls.ErrorDetails.AUDIO_TRACK_LOAD_ERROR ||\n                details === Hls.ErrorDetails.FRAG_LOAD_ERROR ||\n                details === Hls.ErrorDetails.KEY_LOAD_ERROR\n              ) {\n                let rcode = data.response.code;\n                if (rcode === 403) {\n                  openSnackbar(\n                    \"我们已经检测到您的帐号已在其它设备上正在观看，请等待其它设备停止观看后再试!\"\n                  );\n                  /// triggerPlayerTimer(error.url);\n                } else if (rcode === 404) {\n                  openSnackbar(\"观看的流已经下线，将重新刷新观看列表!\");\n                  onRefreshCamlist();\n                } else {\n                  openSnackbar(`服务器返回错误代码:${rcode}`);\n                  onRefreshCamlist();\n                }\n              } else if (\n                details === Hls.ErrorDetails.MANIFEST_LOAD_TIMEOUT ||\n                details === Hls.ErrorDetails.KEY_LOAD_TIMEOUT ||\n                details === Hls.ErrorDetails.LEVEL_LOAD_TIMEOUT\n              ) {\n                openSnackbar(\"加载文件超时，请检查网络是否正常...\");\n                onRefreshCamlist();\n              } else if (\n                details === Hls.ErrorDetails.MANIFEST_PARSING_ERROR ||\n                details === Hls.ErrorDetails.LEVEL_EMPTY_ERROR\n              ) {\n                openSnackbar(`解析mainfest错误: ${data.reason}`);\n              } else {\n                openSnackbar(\"服务器出了点问题，请稍候再试!\");\n              }\n            } else {\n              openSnackbar(\n                \"无法播放此视频,错误类型：\" +\n                  data.type +\n                  \",错误代码:\" +\n                  data.details +\n                  \",描述:\" +\n                  data.reason\n              );\n            }\n          }\n        }\n      });\n    },\n    [autoplay, hlsConfig, onRefreshCamlist, streamUri, tryPlaying]\n  );\n\n  /** Native load and play */\n  const nativePlay = React.useCallback(\n    (mutual) => {\n      // hls.js is not supported on platforms that do not have Media Source Extensions (MSE) enabled.\n      // When the browser has built-in HLS support (check using `canPlayType`), we can provide an HLS manifest (i.e. .m3u8 URL) directly to the video element through the `src` property.\n      // This is using the built-in support of the plain video element, without using hls.js.\n      // Note: it would be more normal to wait on the 'canplay' event below however on Safari (where you are most likely to find built-in HLS support) the video.src URL must be on the user-driven\n      // white-list before a 'canplay' event will be emitted; the last video event that can be reliably listened-for when the URL is not on the white-list is 'loadedmetadata'.\n      console.log(\"Browser not support mse, but can play m3u8!\");\n      setLoading(true);\n      refVideo.current.src = streamUri;\n      refVideo.current.load();\n      refVideo.current.oncanplaythrough = (event) => {\n        setDuration(get_duration(refVideo.current));\n        let hasaudio = has_audio(refVideo.current);\n        setHasAudio(hasaudio);\n        if (autoplay || mutual) {\n          tryPlaying(hasaudio);\n        }\n      };\n\n      refVideo.current.onerror = (error) => {\n        setLoading(false);\n        refVideo.current.pause();\n        refVideo.current.src = \"\";\n        refVideo.current.removeAttribute(\"src\"); // empty source\n        refVideo.current.load();\n        setState(PLAYER_STATE_ERROR);\n        console.log(error);\n        console.log(`Network status:${refVideo.networkState}`);\n        /** Handle native video error */\n        let ecode = error.code;\n        let msg = \"\";\n        switch (ecode) {\n          case MediaError.MEDIA_ERR_NETWORK:\n            msg = \"播放超时，将重新刷新观看列表...\";\n            onRefreshCamlist();\n            break;\n          case MediaError.MEDIA_ERR_DECODE:\n            msg = \"浏览器不支持播放该视频格式!\";\n            break;\n          case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:\n            msg = \"不支持的播放格式，将重刷新列表...\";\n            onRefreshCamlist();\n            break;\n          case MediaError.MEDIA_ERR_ABORTED:\n            msg = \"请求播放终止.\";\n            break;\n          default:\n            msg = \"未知错误!\";\n            break;\n        }\n        openSnackbar(`error:${msg}`);\n      };\n    },\n    [autoplay, onRefreshCamlist, streamUri, tryPlaying]\n  );\n\n  React.useLayoutEffect(() => {\n    if (refVidContainer.current) {\n      setDimensions({\n        width: refVidContainer.current.offsetWidth,\n        height: refVidContainer.current.offsetHeight\n      });\n      console.log(\n        `useLayoutEffect, width:${refVidContainer.current.offsetWidth}, height:${refVidContainer.current.offsetHeight}`\n      );\n    }\n  }, []);\n\n  React.useEffect(() => {\n    if (browser.isIos) {\n      refVideo.current.setAttribute(\"webkit-playsinline\", true);\n      refVideo.current.setAttribute(\"x-webkit-airplay\", \"allow\");\n    } else if (browser.isX5) {\n      refVideo.current.setAttribute(\"x5-video-player-type\", \"h5-page\");\n      refVideo.current.setAttribute(\"x5-video-player-fullscreen\", \"true\");\n      refVideo.current.setAttribute(\"x5-video-orientation\", \"landscape\");\n    }\n  }, []);\n\n  React.useEffect(() => {\n    if (messages.length > 0) {\n      let last = messages[messages.length - 1];\n      setBarrageMessage(last);\n    }\n  }, [messages]);\n\n  React.useEffect(() => {\n    if (checkMpd) {\n      console.log(`check stream uri:${checkMpd}`);\n      /**Player uri or refreshMpdId changed */\n      setLoading(true);\n      fetch(checkMpd, {\n        credentials: \"include\",\n        headers: {\n          Accept: \"application/x-mpegURL\",\n          \"Content-type\": \"application/x-mpegURL\"\n        },\n        cache: \"no-cache\",\n        method: \"GET\",\n        mode: \"cors\"\n      })\n        .then((response) => {\n          setLoading(false);\n          if (response.status === 404) {\n            /// 直播流已经下线\n            openSnackbar(\"直播流已经下线!\");\n            onRefreshCamlist();\n          } else if (response.status === 403) {\n            /// 多人同时观看\n            openSnackbar(\n              \"我们已经检测到您的帐号已在其它设备上正在观看，请等待其它设备停止观看后再试!\"\n            );\n          } else if (response.status === 200) {\n            /** 检查成功 */\n            setStreamUri(checkMpd);\n          } else {\n            /** 其它错误 */\n            openSnackbar(`服务器返回错误代码:${response.status}`);\n          }\n          return response.text();\n        })\n        .then((respText) => {\n          openSnackbar(`fetch mpd:${respText}`);\n        })\n        .catch((error) => {\n          setLoading(false);\n          openSnackbar(\"fetch play uri error:\", error.message);\n        });\n    }\n  }, [checkMpd, onRefreshCamlist]);\n\n  React.useEffect(() => {\n    console.log(\n      `HLSPlayer useEffect,url:${url},hls:${refHls.current},video:${refVideo.current}`\n    );\n    if (url) {\n      if (Hls.isSupported()) {\n        setStreamUri(url);\n      } else {\n        /// Should setCheckMpd(url);but test\n        setStreamUri(url);\n      }\n    }\n  }, [url]);\n\n  React.useEffect(() => {\n    const handleVideoEvent = (event) => {\n      if (event.type === \"play\") {\n        setState(PLAYER_STATE_PLAY);\n        console.log(\"play event!\");\n      } else if (event.type === \"pause\") {\n        console.log(\"pause event!\");\n        setState(PLAYER_STATE_PAUSE);\n      } else if (event.type === \"abort\") {\n        console.log(\"abort event!\");\n        setLoading(false);\n        setState(PLAYER_STATE_ABORT);\n      } else if (event.type === \"ended\") {\n        console.log(\"ended event!\");\n        refVideo.current.currentTime = 0;\n        setLoading(false);\n        setState(PLAYER_STATE_ENDED);\n      } else if (event.type === \"waiting\") {\n        console.log(\"waiting event!\");\n        setLoading(true);\n        setState(PLAYER_STATE_WAITING);\n      } else if (event.type === \"playing\") {\n        console.log(\"playing event!\");\n        setLoading(false);\n        setState(PLAYER_STATE_PLAYING);\n        /// show controls delay 5 seconds\n        refControls.current.classList.toggle(\"show\");\n        setTimeout(() => {\n          refControls.current.classList.toggle(\"show\");\n        }, 5000);\n      } else if (event.type === \"suspend\") {\n        console.log(\"suspend event!\");\n        setState(PLAYER_STATE_SUSPEND);\n        setLoading(false);\n      } else if (event.type === \"stalled\") {\n        console.log(\"stalled event!\");\n        setState(PLAYER_STATE_STALLED);\n      } else if (event.type === \"empied\") {\n        console.log(\"emptied event!\");\n        setState(PLAYER_STATE_EMPTIED);\n        setLoading(false);\n      }\n    };\n\n    const registerVideoEvents = () => {\n      refVideo.current.addEventListener(\"play\", handleVideoEvent);\n      refVideo.current.addEventListener(\"pause\", handleVideoEvent);\n      refVideo.current.addEventListener(\"abort\", handleVideoEvent);\n      refVideo.current.addEventListener(\"playing\", handleVideoEvent);\n      refVideo.current.addEventListener(\"emptied\", handleVideoEvent);\n      refVideo.current.addEventListener(\"ended\", handleVideoEvent);\n      refVideo.current.addEventListener(\"stalled\", handleVideoEvent);\n      refVideo.current.addEventListener(\"suppend\", handleVideoEvent);\n    };\n\n    const unregisterVideoEvents = () => {\n      refVideo.current.removeEventListener(\"play\", handleVideoEvent);\n      refVideo.current.removeEventListener(\"pause\", handleVideoEvent);\n      refVideo.current.removeEventListener(\"abort\", handleVideoEvent);\n      refVideo.current.removeEventListener(\"playing\", handleVideoEvent);\n      refVideo.current.removeEventListener(\"emptied\", handleVideoEvent);\n      refVideo.current.removeEventListener(\"ended\", handleVideoEvent);\n      refVideo.current.removeEventListener(\"stalled\", handleVideoEvent);\n      refVideo.current.removeEventListener(\"suppend\", handleVideoEvent);\n    };\n    const videoElement = refVideo.current;\n    if (streamUri) {\n      console.log(`play stream uri:${streamUri}`);\n      setLoading(false);\n      if (Hls.isSupported()) {\n        if (refHls.current) {\n          console.log(\"Destory hls!\");\n          refHls.current.stopLoad();\n          refHls.current.detachMedia();\n        }\n        registerVideoEvents();\n        msePlay(false);\n      } else if (videoElement.canPlayType(\"application/vnd.apple.mpegurl\")) {\n        videoElement.pause();\n        videoElement.src = \"\"; // empty source\n        videoElement.removeAttribute(\"src\");\n        videoElement.load();\n        registerVideoEvents();\n        nativePlay(false);\n      } else {\n        openSnackbar(\n          \"浏览器太老了,请下载一款支持MediaSourceExtension功能的浏览器!\"\n        );\n      }\n    }\n    return () => {\n      if (refHls.current) {\n        console.log(\"Destory hls!\");\n        refHls.current.stopLoad();\n        refHls.current.detachMedia();\n        refHls.current.destroy();\n      }\n      if (\n        Hls.isSupported() ||\n        videoElement.canPlayType(\"application/vnd.apple.mpegurl\")\n      ) {\n        unregisterVideoEvents();\n      }\n    };\n  }, [streamUri, msePlay, nativePlay]);\n\n  /** Not fullscreen api supported */\n  const toggleDivFullscreen = React.useCallback(\n    (toggle) => {\n      // Store or restore scroll position\n      if (toggle) {\n        setScrollPosition({\n          x: window.pageXOffset || 0,\n          y: window.pageYOffset || 0\n        });\n      } else {\n        window.scrollTo(scrollPosition.x, scrollPosition.y);\n      }\n\n      // Toggle scroll\n      document.body.style.overflow = toggle ? \"hidden\" : \"\";\n\n      // Toggle class hook\n      refVidContainer.current.classList.toggle(\"div__fullscreen\");\n\n      // Force full viewport on iPhone X+\n      if (browser.isIos) {\n        let viewport = document.head.querySelector('meta[name=\"viewport\"]');\n        const property = \"viewport-fit=cover\";\n\n        // Inject the viewport meta if required\n        if (!viewport) {\n          viewport = document.createElement(\"meta\");\n          viewport.setAttribute(\"name\", \"viewport\");\n        }\n\n        // Check if the property already exists\n        const hasProperty =\n          is.string(viewport.content) && viewport.content.includes(property);\n\n        if (toggle) {\n          setCleanupViewport(!hasProperty);\n\n          if (!hasProperty) {\n            viewport.content += `,${property}`;\n          }\n        } else if (cleanupViewport) {\n          viewport.content = viewport.content\n            .split(\",\")\n            .filter((part) => part.trim() !== property)\n            .join(\",\");\n        }\n      }\n      /// Dispatch fullscreen event to video container\n      let fse = null;\n      if (toggle) {\n        fse = new CustomEvent(\"fullscreen\", { detail: { state: \"enter\" } });\n      } else {\n        fse = new CustomEvent(\"fullscreen\", { detail: { state: \"exit\" } });\n      }\n      console.log(`div entered fullscreen mode:${toggle}`);\n      refVidContainer.current.dispatchEvent(fse);\n    },\n    [cleanupViewport, scrollPosition]\n  );\n\n  /** Fullscreen API:\n      https://developer.mozilla.org/en-US/docs/Web/API/Fullscreen_API\n  */\n  const toggleNativeFullscreen = (toggle) => {\n    if (toggle) {\n      /// Enter fullscreen\n      if (refVideo.current.requestFullscreen) {\n        refVidContainer.current.requestFullscreen().catch((err) => {\n          console.error(\"Error:\", err);\n        });\n      } else if (refVideo.current.msRequestFullscreen) {\n        refVideo.current.msRequestFullscreen();\n      } else if (refVideo.current.mozRequestFullScreen) {\n        refVidContainer.current.mozRequestFullScreen();\n      } else if (refVideo.current.webkitRequestFullscreen) {\n        refVidContainer.current.webkitRequestFullscreen(\n          Element.ALLOW_KEYBOARD_INPUT\n        );\n      } else {\n        console.log(\"Browser not support fullscreen API!\");\n      }\n    } else {\n      /// Exit fullscreen\n      if (document.exitFullscreen) {\n        document.exitFullscreen();\n      } else if (document.cancelFullScreen) {\n        document.cancelFullScreen();\n      } else if (document.msExitFullscreen) {\n        document.msExitFullscreen();\n      } else if (document.mozCancelFullScreen) {\n        document.mozCancelFullScreen();\n      } else if (document.webkitExitFullscreen) {\n        document.webkitExitFullscreen();\n      } else {\n        console.log(\"Browser not support fullscreen API!\");\n      }\n    }\n  };\n\n  /** 移动设备屏幕切换处理 */\n  const rotationHandler = React.useCallback(() => {\n    const currentAngle = angle();\n    if (currentAngle === 90 || currentAngle === 270 || currentAngle === -90) {\n      if (refVideo.current.paused === false) {\n        if (browser.supportsNativeFullscreen) {\n          toggleNativeFullscreen(true);\n        } else {\n          toggleDivFullscreen(true);\n        }\n        screen.lockOrientationUniversal(\"landscape\");\n      }\n    }\n    if (currentAngle === 0 || currentAngle === 180) {\n      if (isFullScreen) {\n        if (browser.supportsNativeFullscreen) {\n          toggleNativeFullscreen(false);\n        } else {\n          toggleDivFullscreen(false);\n        }\n      }\n    }\n  }, [isFullScreen, toggleDivFullscreen]);\n\n  /** 全屏事件订阅 */\n  React.useEffect(() => {\n    setMuted(refVideo.current.muted);\n    setVolume(refVideo.current.volume);\n\n    let prefix = get_fullscreen_prefix();\n    let eventName =\n      prefix === \"ms\" ? \"MSFullscreenChange\" : `${prefix}fullscreenchange`;\n\n    /** 订阅document全屏进入/退出事件 */\n    document.addEventListener(eventName, (event) => {\n      // document.fullscreenElement will point to the element that\n      // is in fullscreen mode if there is one. If not, the value\n      // of the property is null.\n      let isfs = is_state_fullscreen();\n      let fse = null;\n      if (isfs) {\n        fse = new CustomEvent(\"fullscreen\", { detail: { state: \"enter\" } });\n      } else {\n        fse = new CustomEvent(\"fullscreen\", { detail: { state: \"exit\" } });\n      }\n      console.log(`document entered fullscreen mode:${isfs}`);\n      /// Notify video container fullscreen event\n      refVidContainer.current.dispatchEvent(fse);\n    });\n  }, []);\n\n  React.useEffect(() => {\n    const handleFullscreenChange = (e) => {\n      if (e.detail.state === \"enter\") {\n        console.log(\"entered fullscreen mode.\");\n        setIsFullScreen(true);\n        if (browser.isAndroid || browser.isIos) {\n          /** 全屏模式下强制切换到横屏 */\n          if (!angle()) {\n            screen.lockOrientationUniversal(\"landscape\");\n          }\n        }\n      } else {\n        console.log(\"Leaving full-screen mode.\");\n        setIsFullScreen(false);\n        onPlayChange(streamUri);\n      }\n    };\n    refVidContainer.current.addEventListener(\n      \"fullscreen\",\n      handleFullscreenChange\n    );\n    return () => {\n      if (refVidContainer.current)\n        refVidContainer.current.removeEventListener(\n          \"fullscreen\",\n          handleFullscreenChange\n        );\n    };\n  }, [onPlayChange, streamUri]);\n\n  React.useEffect(() => {\n    if (browser.isAndroid || browser.isIos) {\n      /** 订阅移动设备屏幕转换事件 */\n      if (browser.isIos) {\n        window.addEventListener(\"orientationchange\", rotationHandler);\n      } else if (screen && screen.orientation) {\n        // addEventListener('orientationchange') is not a user interaction on Android\n        screen.orientation.onchange = rotationHandler;\n      }\n    }\n  }, [rotationHandler]);\n  /** Player Controls event handle */\n  /** 全屏处理 */\n  const handleToggleFullscreen = (event) => {\n    if (browser.supportsNativeFullscreen) {\n      toggleNativeFullscreen(!isFullScreen);\n    } else {\n      console.log(\"Explorer not support fullscreen!\");\n      toggleDivFullscreen(!isFullScreen);\n    }\n  };\n\n  /** 画中画处理 */\n  const handleTogglePip = (event) => {\n    /// safari\n    if (is.function(refVideo.current.webkitSetPresentationMode)) {\n      refVideo.current.webkitSetPresentationMode(\n        refVideo.current.webkitPresentationMode === \"picture-in-picture\"\n          ? \"inline\"\n          : \"picture-in-picture\"\n      );\n      return;\n    }\n    /// chrome\n    if (document.pictureInPictureElement) {\n      document.exitPictureInPicture();\n    } else {\n      if (document.pictureInPictureEnabled) {\n        refVideo.current.requestPictureInPicture();\n      }\n    }\n  };\n\n  /** AirPlay 处理 */\n  const handleAirplay = (event) => {\n    // Show dialog if supported\n    if (browser.airplay) {\n      refVideo.current.webkitShowPlaybackTargetPicker();\n    }\n  };\n\n  /** 音量处理 */\n  const handleVolumeChange = (event) => {\n    console.log(`volume:${event.target.value}`);\n    refVideo.current.volume = event.target.value;\n    setVolume(event.target.value);\n    if (event.target.value === \"0\") {\n      setMuted(true);\n      refVideo.current.muted = true;\n    } else {\n      if (muted) {\n        setMuted(false);\n        refVideo.current.muted = false;\n      }\n    }\n  };\n\n  /** 静音处理 */\n  const handleMuted = (event) => {\n    refVideo.current.muted = !muted;\n    setMuted((state) => !state);\n    if (refVideo.current.muted) {\n      setVolume(0.0);\n    } else {\n      setVolume(1.0);\n    }\n  };\n\n  /** Play or pause 处理 */\n  const handlePlayOrPause = (event) => {\n    if (state === PLAYER_STATE_PAUSE) {\n      tryPlaying(hasAudio);\n    } else if (state === PLAYER_STATE_PLAYING) {\n      refVideo.current.pause();\n    } else {\n      if (Hls.isSupported()) {\n        msePlay(true);\n      } else {\n        nativePlay(true);\n      }\n    }\n  };\n\n  /** 弹幕开关处理 */\n  const toggleBarrage = (event) => {\n    setIsBarrage((flag) => !flag);\n  };\n\n  /** 全屏菜单处理 */\n  const toggleFullscreenMenu = (event) => {\n    refFsMenu.current.classList.toggle(\"show\");\n  };\n\n  /** 处理用户点击播放列表 */\n  const handlePlayUri = (playUri) => {\n    console.log(`Screenfull play uri:${playUri}`);\n    if (Hls.isSupported()) {\n      setStreamUri(playUri);\n    } else {\n      setCheckMpd(playUri);\n    }\n  };\n\n  /** 发送聊天消息 */\n  const handleSendMessage = () => {\n    if (message) {\n      onSendMessage(message);\n      setMessage(\"\");\n    }\n  };\n\n  console.log(\"HLSPlayer render!\");\n  return (\n    <div ref={refVidContainer} className=\"video__container\">\n      <video\n        ref={refVideo}\n        width={dimensions.width}\n        hieght={dimensions.height}\n        controls={controls}\n        crossOrigin=\"use-credentials\"\n        poster={poster}\n        preload=\"auto\"\n        autoPlay\n        playsInline\n        muted=\"muted\"\n        {...videoProps}\n      />\n      {loading && (\n        <div className=\"loader\">\n          <div />\n          <div />\n          <div />\n        </div>\n      )}\n      <div ref={refControls} className=\"video__controls\">\n        <button id=\"playpause\" onClick={handlePlayOrPause}>\n          {state === PLAYER_STATE_PLAYING ? <FaPause /> : <FaPlay />}\n        </button>\n        {duration > 0 ? (\n          <div className=\"seeker\">\n            <progress\n              id=\"progressbar\"\n              className=\"progressbar\"\n              max={100}\n              defaultValue={seekval}\n            ></progress>\n            <input\n              type=\"range\"\n              id=\"seekbar\"\n              value={seekval}\n              className=\"seekbar\"\n              onChange={(e) => setSeekval(e.target.value)}\n            />\n          </div>\n        ) : (\n          <div className=\"live\">直播</div>\n        )}\n        {isFullScreen ? (\n          <div className=\"chat__container\">\n            <input\n              type=\"text\"\n              placeholder=\"说点什么？\"\n              value={message}\n              onChange={(event) => setMessage(event.target.value.trim())}\n              onKeyPress={(event) => {\n                if (event.key === \"Enter\") {\n                  event.preventDefault();\n                  handleSendMessage();\n                }\n              }}\n            />\n            <button id=\"chat\" onClick={(e) => handleSendMessage()}>\n              <FaTelegramPlane />\n            </button>\n          </div>\n        ) : (\n          <div className=\"chat__container\" />\n        )}\n\n        {hasAudio && (\n          <div className=\"volume__container\">\n            <button id=\"mute\" onClick={handleMuted}>\n              {muted ? <FaVolumeMute /> : <FaVolumeUp />}\n            </button>\n            <input\n              type=\"range\"\n              id=\"volumebar\"\n              className=\"volumebar\"\n              value={volume}\n              min={0}\n              max={1.0}\n              step={0.1}\n              onChange={handleVolumeChange}\n            />\n          </div>\n        )}\n        {browser.pip && (\n          <button id=\"picture-in-picture\" onClick={handleTogglePip}>\n            <FaExternalLinkAlt />\n          </button>\n        )}\n        {browser.airplay && (\n          <button id=\"airplay\" onClick={handleAirplay}>\n            <FaOsi />\n          </button>\n        )}\n        {isFullScreen && (\n          <button id=\"barrage-toggle\" onClick={toggleBarrage}>\n            {isBarrage ? <BarrageIconOn /> : <BarrageIconOff />}\n          </button>\n        )}\n        <button id=\"fullscreen\" onClick={handleToggleFullscreen}>\n          {isFullScreen ? <FaExpandAlt /> : <FaExpand />}\n        </button>\n        {isFullScreen && (\n          <button\n            ref={refFsMenuBut}\n            id=\"menu-more\"\n            onClick={toggleFullscreenMenu}\n          >\n            <FaBars />\n          </button>\n        )}\n      </div>\n      <div ref={refFsMenu} className=\"sidedlg\">\n        {cameras && <CameraList camlist={cameras} onPlayUri={handlePlayUri} />}\n        <Jabber messages={messages} />\n      </div>\n      {isFullScreen && isBarrage && barrageMessage && (\n        <Barrage message={barrageMessage} />\n      )}\n    </div>\n  );\n}\n\nHLSPlayer.propTypes = {\n  url: PropTypes.string.isRequired,\n  controls: PropTypes.bool,\n  autoplay: PropTypes.bool,\n  hlsConfig: PropTypes.object, //https://github.com/dailymotion/hls.js/blob/master/API.md#fine-tuning\n  poster: PropTypes.string,\n  videoProps: PropTypes.object,\n  cameras: PropTypes.object,\n  messages: PropTypes.array,\n  onRefreshCamlist: PropTypes.func,\n  onSendMessage: PropTypes.func,\n  onPlayChange: PropTypes.func\n};\n\nHLSPlayer.defaultProps = {\n  url: \"https://anylooker.com/live/51060300001310000308_master.m3u8\",\n  controls: false,\n  autoplay: true,\n  hlsConfig: {\n    liveDurationInfinity: true,\n    xhrSetup: function (xhr, url) {\n      xhr.responseType = \"text\";\n      xhr.withCredentials = true; // do send cookies\n    },\n    fetchSetup: function (context, initParams) {\n      // Always send cookies, even for cross-origin calls.\n      initParams.credentials = \"include\";\n      return new Request(context.url, initParams);\n    }\n  },\n  poster: \"\",\n  videoProps: {},\n  cameras: {},\n  messages: [],\n  onRefreshCamlist: () => {},\n  onSendMessage: () => {},\n  onPlayChange: () => {}\n};\n","import React from \"react\";\nimport { FaTimesCircle } from \"react-icons/fa\";\nimport { PropTypes } from \"prop-types\";\nimport \"./modal.css\";\nexport default function Modal(props) {\n  const { title, show, onClose, children } = props;\n  const refModal = React.useRef();\n  React.useEffect(() => {\n    if (show) {\n      refModal.current.style.display = \"block\";\n    } else {\n      refModal.current.style.display = \"none\";\n    }\n  }, [show]);\n\n  const handleCloseClick = (e) => {\n    refModal.current.style.display = \"none\";\n    onClose();\n  };\n\n  return (\n    <div ref={refModal} className=\"modal\">\n      <div className=\"modal-content\">\n        <div className=\"modal-header\">\n          <span className=\"close\" onClick={handleCloseClick}>\n            <FaTimesCircle />\n          </span>\n          <span style={{ fontSize: \"18px\" }}>{title}</span>\n        </div>\n        <div className=\"modal-body\">{children}</div>\n      </div>\n    </div>\n  );\n}\n\nModal.propTypes = {\n  title: PropTypes.string.isRequired,\n  show: PropTypes.bool.isRequired,\n  onClose: PropTypes.func.isRequired\n};\n\nModal.defaultProps = {\n  title: \"班级修改\",\n  show: true,\n  onClose: () => {}\n};\n","import React from \"react\";\nimport Modal from \"./modal\";\nimport ASTooltip from \"./as_tooltip\";\nimport CryptoJS from \"crypto-js\";\nimport http from \"../http_common\";\nimport \"./common.css\";\nimport \"./floating_input.css\";\n\nexport default function ChangePassword(props) {\n  const { username, token, show, onClose } = props;\n  const [oldPwd, setOldPwd] = React.useState(\"\");\n  const [newPwd, setNewPwd] = React.useState(\"\");\n  const [confirmPwd, setConfirmPwd] = React.useState(\"\");\n  const [message, setMessage] = React.useState({\n    show: false,\n    text: \"\"\n  });\n  const refBut = React.useRef();\n  function calcToken(username, password, path) {\n    let h1 = CryptoJS.SHA1(username + \":\" + password).toString();\n    let h2 = CryptoJS.SHA1(password + \":\" + path).toString();\n    let h3 = CryptoJS.SHA1(username + \":\" + password + \":\" + path).toString();\n    let token = CryptoJS.SHA1(h1 + \":\" + h2 + \":\" + h3).toString();\n    return token;\n  }\n\n  /** From  cookies invalidate old password */\n  function validateOldPwd(oldpwd) {\n    let isok = false;\n    let path = \"/sapling/login\";\n    let ctoken = calcToken(username, oldpwd, path);\n    if (ctoken !== token) {\n      path = \"/sapling/get_camera_list\";\n      ctoken = calcToken(username, oldpwd, path);\n      isok = ctoken === token ? true : false;\n    } else {\n      isok = true;\n    }\n    return isok;\n  }\n  const handleSubmit = (event) => {\n    event.preventDefault();\n    if (newPwd !== confirmPwd) {\n      setMessage({\n        ...message,\n        show: true,\n        text: \"重复输入的新口令与新口令不一致!\"\n      });\n      return;\n    }\n\n    if (!validateOldPwd(oldPwd)) {\n      setMessage({\n        ...message,\n        show: true,\n        text: \"老口令错误!\"\n      });\n      return;\n    }\n\n    let bkey = CryptoJS.MD5(username + \":\" + oldPwd);\n    let t = Date.now();\n    let benc = CryptoJS.AES.encrypt(newPwd, bkey, {\n      iv: t,\n      mode: CryptoJS.mode.CTR,\n      padding: CryptoJS.pad.NoPadding\n    });\n    let senc = CryptoJS.enc.Hex.stringify(benc);\n    http\n      .get(`/sapling/change_password?newpwd=${senc}&counter=${t}`)\n      .then((response) => {\n        const ERR_NO_ACCOUNT = 0x800000f;\n        const ERR_PWD = 0x8000010;\n        const ERR_ACCESS_DEINED = 0x8000014;\n        if (response.data.result === 0) {\n          setMessage({\n            ...message,\n            show: true,\n            text: \"修改口令成功!\"\n          });\n          onClose();\n        } else if (response.data.result === ERR_NO_ACCOUNT) {\n          setMessage({\n            ...message,\n            show: true,\n            text: \"帐户不存在!\"\n          });\n        } else if (response.data.result === ERR_PWD) {\n          setMessage({\n            ...message,\n            show: true,\n            text: \"老口令错误!\"\n          });\n        } else if (response.data.result === ERR_ACCESS_DEINED) {\n          setMessage({\n            ...message,\n            show: true,\n            text: \"此帐户无权修改!\"\n          });\n        } else {\n          setMessage({\n            ...message,\n            show: true,\n            text: \"未知错误!\"\n          });\n        }\n      })\n      .catch((e) =>\n        setMessage({\n          ...message,\n          show: true,\n          text: e.toJSON().message\n        })\n      );\n  };\n\n  return (\n    <Modal title=\"口令修改\" show={show} onClose={onClose}>\n      <form className=\"formContainer\" onSubmit={handleSubmit}>\n        <div className=\"form__div\">\n          <input\n            id=\"oldpwd\"\n            type=\"password\"\n            required\n            className=\"form__input\"\n            placeholder=\" \"\n            value={oldPwd}\n            onChange={(e) => setOldPwd(e.target.value.trim())}\n          />\n          <label htmlFor=\"oldpwd\" className=\"form__label\">\n            请输入原口令\n          </label>\n        </div>\n        <div className=\"form__div\">\n          <input\n            id=\"newpwd\"\n            required\n            type=\"password\"\n            className=\"form__input\"\n            placeholder=\" \"\n            value={newPwd}\n            onChange={(e) => setNewPwd(e.target.value.trim())}\n          />\n          <label htmlFor=\"newpwd\" className=\"form__label\">\n            请输入新口令\n          </label>\n        </div>\n        <div className=\"form__div\">\n          <input\n            id=\"repeatpwd\"\n            type=\"password\"\n            required\n            className=\"form__input\"\n            placeholder=\" \"\n            value={confirmPwd}\n            onChange={(e) => setConfirmPwd(e.target.value.trim())}\n          />\n          <label htmlFor=\"repeatpwd\" className=\"form__label\">\n            请再输入一次新口令\n          </label>\n        </div>\n        <button ref={refBut} type=\"submit\" className=\"full_btn\">\n          确认\n        </button>\n      </form>\n      <ASTooltip\n        ref={refBut}\n        delay={5000}\n        show={message.show}\n        onClose={() => setMessage({ ...message, show: false })}\n      >\n        <p>{message.text}</p>\n      </ASTooltip>\n    </Modal>\n  );\n}\n","import React from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport ChangePassword from \"./change_pwd\";\nimport http from \"../http_common\";\nimport { useSnackbar } from \"./use_snackbar\";\nimport { useOutsideClick } from \"../utils/hook\";\nimport PropTypes from \"prop-types\";\nimport \"./common.css\";\nimport \"./personal.css\";\n\nconst Person = React.forwardRef((props, ref) => {\n  const navigate = useNavigate();\n  const [openSnackbar] = useSnackbar();\n  const { open, onOutsideClick } = props;\n  const [user, setUser] = React.useState({\n    username: \"2523452345\",\n    nick_name: \"成怡\",\n    end_ts: \"2022-09-01\"\n  });\n  const [showChangePwd, setShowChangePwd] = React.useState(false);\n  const refAvatar = React.useRef();\n  const refSelf = React.useRef();\n  useOutsideClick(refSelf, onOutsideClick);\n  React.useEffect(() => {\n    http\n      .get(\"/sapling/get_user_info\")\n      .then((response) => {\n        if (response.data.result === 0) {\n          setUser(response.data.info);\n          if (response.data.info.photo) {\n            refAvatar.current.src = `imgs/${response.data.info.username}.${response.data.info.photo}`;\n          } else {\n            refAvatar.current.src = \"imgs/img_avatar_unknow.png\";\n          }\n        } else {\n          openSnackbar(\n            `get_user_info,Server respone error:${response.data.result}`\n          );\n        }\n      })\n      .catch((e) => openSnackbar(e.toJSON().message));\n  }, []);\n\n  React.useEffect(() => {\n    if (open) {\n      refSelf.current.style.display = \"flex\";\n    } else {\n      refSelf.current.style.display = \"none\";\n    }\n  }, [open]);\n\n  /// expose function getDisplayName\n  React.useImperativeHandle(ref, () => ({\n    getName: () => (user ? user.nick_name : \"\"),\n    getEndts: () => (user ? user.end_ts : Date.now()),\n    getPhoto: () => (user ? user.photo : \"\")\n  }));\n\n  /// 处理文件上传\n  const handleFileUpload = (event) => {\n    const selectedFile = event.target.files[0];\n    if (selectedFile.size > 50 * 1024) {\n      openSnackbar(\"选择的头像文件不能超过50KB！\");\n      return;\n    }\n\n    let ext = selectedFile.name.split(\".\").pop();\n    if (!ext) {\n      openSnackbar(\"选择的头像文件扩展名必须为png或jpg！\");\n      return;\n    }\n\n    refAvatar.current.src = URL.createObjectURL(selectedFile);\n\n    let mfields = new FormData();\n    mfields.append(\"username\", user.username);\n    let upload_file = `${user.username}.${ext}`;\n    mfields.append(\"photo\", selectedFile, upload_file);\n    user.photo = ext;\n\n    http\n      .post(\"/sapling/modify_subuser\", mfields)\n      .then((response) => {\n        if (response.data.result === 0) {\n          /// Modify successed!\n          openSnackbar(\"修改头像成功!\");\n        }\n      })\n      .catch((e) => openSnackbar(`修改头像失败:e.toJSON().message`));\n  };\n\n  /// 处理修改口令\n  const handleChangePwd = (event) => {\n    event.preventDefault();\n    setShowChangePwd(true);\n  };\n\n  /// 切换登录\n  const handleSwitchLogin = (event) => {\n    event.preventDefault();\n    navigate(\"/login\", {\n      replace: true,\n      state: { from: \"/player\" }\n    });\n  };\n\n  return (\n    <div ref={refSelf} className=\"personal_card\">\n      <div className=\"personal-image\">\n        <label>\n          <input\n            type=\"file\"\n            id=\"modify-teacher-photo-file-upload\"\n            accept=\"image/png, image/jpeg\"\n            onChange={handleFileUpload}\n          />\n          <figure className=\"personal-figure\">\n            <img\n              ref={refAvatar}\n              src=\"http://localhost/imgs/img_avatar_unknow.png\"\n              className=\"personal-avatar\"\n              alt=\"avatar\"\n            />\n            <figcaption className=\"personal-figcaption\">\n              <img\n                src=\"http://localhost/imgs/img_camera_white.png\"\n                alt=\"avatar-camera\"\n              />\n            </figcaption>\n          </figure>\n        </label>\n      </div>\n      <div className=\"personal-content\">\n        <h3>{user.nick_name}</h3>\n        <p>{`登录用户名：${user.username}`}</p>\n        <p>{`帐户截止日期：${user.end_ts}`}</p>\n        <button type=\"submit\" className=\"full_btn\" onClick={handleChangePwd}>\n          修改口令\n        </button>\n        <button type=\"submit\" className=\"full_btn\" onClick={handleSwitchLogin}>\n          切换登录\n        </button>\n      </div>\n      <ChangePassword\n        show={showChangePwd}\n        onClose={() => setShowChangePwd(false)}\n      />\n    </div>\n  );\n});\nPerson.propTypes = {\n  open: PropTypes.bool.isRequired,\n  onOutsideClick: PropTypes.func.isRequired\n};\nPerson.defaultProps = {\n  open: true,\n  onOutsideClick: () => {}\n};\nexport default Person;\n","import React from \"react\";\nimport browser from \"../utils/browser\";\nimport { useOutsideClick } from \"../utils/hook\";\nimport \"./info.css\";\nexport default function Info(props) {\n  const { open, onOutsideClick } = props;\n  const refSelf = React.useRef();\n  useOutsideClick(refSelf, onOutsideClick);\n  React.useEffect(() => {\n    if (open) refSelf.current.style.display = \"flex\";\n    else refSelf.current.style.display = \"none\";\n  }, [open]);\n  return (\n    <div>\n      <div ref={refSelf} className=\"sideinfo\">\n        <p>{`浏览器：${window.navigator.userAgent}`}</p>\n        <p>{`MSE支持：${browser.supportsMediaSource}`}</p>\n        <p>{`原生全屏API支持：${browser.supportsNativeFullscreen}`}</p>\n        <p>{`ShadowDOM支持：${browser.supportsShadowDOM}`}</p>\n        <p>{`WebAssembly支持：${browser.supportsWASM}`}</p>\n        <p>{`画中画播放支持：${browser.pip}`}</p>\n        <p>{`AirPlay播放支持：${browser.airplay}`}</p>\n        <p>{`X5内核：${browser.isX5}`}</p>\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { FaInfo, FaUser, FaTelegramPlane } from \"react-icons/fa\";\nimport { UserContext } from \"../user_context\";\nimport HLSPlayer from \"./hlsplayer\";\nimport CameraList from \"./camera_list\";\nimport Person from \"./person\";\nimport Info from \"./info\";\nimport Jabber from \"./jabber\";\nimport { tlv_serialize_object, tlv_unserialize_object } from \"./tlv\";\nimport Websocket from \"./websocket\";\nimport \"./live_player.css\";\n\nconst ENDPOINT = \"wss://localhost/ws_group_chat\";\n\nexport default function LivePlayer(props) {\n  const userCtx = React.useContext(UserContext);\n  const username = userCtx.user.username;\n  const ws = React.useRef(null);\n  const [streamUri, setStreamUri] = React.useState(\"\");\n  const [camlist, setCamlist] = React.useState(null);\n  const [camsRefreshId, setCamsRefreshId] = React.useState(0);\n  const [showPerson, setShowPerson] = React.useState(false);\n  const [showInfo, setShowInfo] = React.useState(false);\n  const [chatText, setChatText] = React.useState(\"\");\n  const [messages, setMessages] = React.useState([]);\n  const refPersonBut = React.useRef();\n  const refInfoBut = React.useRef();\n  const refPerson = React.useRef();\n\n  /** 从服务器获取摄像头列表 */\n  React.useEffect(() => {\n    const ERR_NO_ACCOUNT = 0x800000f;\n    const ERR_INVALID_PWD = ERR_NO_ACCOUNT + 1;\n    const ERR_OVERDUE = ERR_INVALID_PWD + 1;\n    fetch(`/sapling/get_camera_list?ts=${Date.now()}`, {\n      credentials: \"include\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-type\": \"application/json\"\n      },\n      cache: \"no-cache\",\n      method: \"GET\",\n      mode: \"cors\"\n    })\n      .then((response) => {\n        if (response.ok) {\n          const resp = response.json();\n          if (resp.result === 0) {\n            setCamlist(resp.cameras);\n          } else if (resp.result === ERR_NO_ACCOUNT) {\n            console.log(\"帐户不存在!\");\n          } else if (resp.result === ERR_INVALID_PWD) {\n            console.log(\"口令错误!\");\n          } else if (resp.result === ERR_OVERDUE) {\n            console.log(\"帐户已过期!\");\n          } else {\n            console.log(`get_camera_list response error code:${resp.result}`);\n            setCamlist({\n              cameras: [\n                { oid: \"51060300001310000006\", name: \"门卫\", status: 1 },\n                { oid: \"51060300001310000308\", name: \"大厅\", status: 1 }\n              ]\n            });\n          }\n        } else {\n          throw new Error(`Server repsone status:${response.status}`);\n        }\n      })\n      .catch((e) => console.error(\"Error:\", e));\n  }, [camsRefreshId]);\n\n  /** 处理用户点击播放列表 */\n  const handlePlayUri = (uri, is_main_stream) => {\n    setStreamUri(uri);\n    /**\n    if (!is_main_stream) {\n      if (isMainStream) refVideo.current.classList.add(\"aspect_ratio_d1\");\n    } else {\n      if (!isMainStream) refVideo.current.classList.remove(\"aspect_ratio_d1\");\n    }\n    setIsMainStream(is_main_stream); */\n  };\n\n  /** 处理 HLSPlayer 传来的刷新播放列表的消息 */\n  const handleRefreshCamList = React.useCallback(() => {\n    setCamsRefreshId((rid) => rid + 1);\n  }, []);\n\n  /** 处理 HLSPlayer 传来的播放列表变化的消息 */\n  const handlePalyChange = React.useCallback(\n    (uri) => {\n      if (uri !== streamUri) {\n        setStreamUri(uri);\n        setCamlist({ ...camlist });\n      }\n    },\n    [camlist, streamUri]\n  );\n\n  /** 点击个人信息 */\n  const handlePersonClick = (event) => {\n    setShowPerson(!showPerson);\n  };\n\n  /** 个人信息关闭事件*/\n  const handlePersonClose = React.useCallback((event) => {\n    if (!refPersonBut.current.contains(event.target)) {\n      setShowPerson(false);\n    }\n  }, []);\n\n  /** 点击信息显示 */\n  const handleInfoClick = (event) => {\n    setShowInfo(!showInfo);\n  };\n\n  /** 信息关闭 */\n  const handleInfoClose = React.useCallback((event) => {\n    if (!refInfoBut.current.contains(event.target)) {\n      setShowInfo(false);\n    }\n  }, []);\n\n  /** Assembly jabber message and send to websocket */\n  const assemblySendMessage = React.useCallback(\n    (text) => {\n      let msg = {};\n      msg.from =\n        refPerson.current.getName() +\n        \":\" +\n        refPerson.current.getPhoto() +\n        \"@\" +\n        username;\n      msg.to = \"all\";\n      msg.type = \"jabber\";\n      msg.content = text;\n      msg.ts = Date.now();\n      let binMsg = tlv_serialize_object(msg);\n      ws.current.sendMessage(binMsg, (result) => {\n        console.log(\"Send message success!\");\n      });\n      msg.to = username;\n      setMessages([...messages, msg]);\n    },\n    [messages, username]\n  );\n\n  /** 处理 HLSPlayer 传来的发送聊天的消息*/\n  const handleJabberFromPlayer = React.useCallback(\n    (text) => {\n      assemblySendMessage(text);\n    },\n    [assemblySendMessage]\n  );\n\n  /** 点击聊天 */\n  const handleJabber = (event) => {\n    if (!chatText) return;\n    assemblySendMessage(chatText);\n    setChatText(\"\");\n  };\n\n  /** Websocket callbacks */\n  const ws_onopen = (e) => {\n    let msg = {\n      from: \"系统消息:jpg@admin\",\n      content: \"已经连接到聊天服务器，您可以聊天，聊天时请注意文明用语！\",\n      ts: Date.now()\n    };\n    setMessages([...messages, msg]);\n  };\n  const ws_onclose = (e) => {\n    let msg = {\n      from: \"系统消息:jpg@admin\",\n      content: \"与聊天服务器断开，聊天暂时不可用！\",\n      ts: Date.now()\n    };\n    setMessages([...messages, msg]);\n  };\n  const ws_onerror = (e) => {\n    let msg = {\n      from: \"系统消息:jpg@admin\",\n      content: `与聊天服务器通信发生错误，错误代码:${e.code}！`,\n      ts: Date.now()\n    };\n    setMessages([...messages, msg]);\n  };\n\n  const ws_onmessage = (data) => {\n    const wsmsg = tlv_unserialize_object(data);\n    for (const [key, value] of Object.entries(wsmsg)) {\n      if (key === \"on_message\") {\n        console.log(value);\n        setMessages([...messages, value]);\n      } else {\n        console.log(`Unknown ws onmessage method:${key}`);\n      }\n    }\n  };\n\n  const hlsconfig = React.useMemo(\n    () => ({\n      liveDurationInfinity: true,\n      xhrSetup: function (xhr, url) {\n        xhr.withCredentials = true; // do send cookies\n      },\n      fetchSetup: function (context, initParams) {\n        // Always send cookies, even for cross-origin calls.\n        initParams.credentials = \"include\";\n        return new Request(context.url, initParams);\n      }\n    }),\n    []\n  );\n  return (\n    <div className=\"container\">\n      {username && (\n        <Websocket\n          ref={ws}\n          url={`${ENDPOINT}?username=${username}`}\n          onOpen={ws_onopen}\n          onMessage={ws_onmessage}\n          onClose={ws_onclose}\n          onError={ws_onerror}\n          reconnect={true}\n          debug={true}\n          protocol=\"jabber\"\n        />\n      )}\n      <HLSPlayer\n        url={streamUri}\n        autoplay={true}\n        hlsConfig={hlsconfig}\n        poster=\"\"\n        videoProps={{}}\n        cameras={camlist}\n        messages={messages}\n        onRefreshCamlist={handleRefreshCamList}\n        onSendMessage={handleJabberFromPlayer}\n        onPlayChange={handlePalyChange}\n      />\n      <div className=\"content__container\">\n        <div className=\"inner__content-container\">\n          {camlist && (\n            <CameraList camlist={camlist} onPlayUri={handlePlayUri} />\n          )}\n          <Jabber messages={messages} />\n        </div>\n      </div>\n      <div className=\"navbar\">\n        <div ref={refPersonBut} className=\"icon\" onClick={handlePersonClick}>\n          <FaUser />\n        </div>\n        <div ref={refInfoBut} className=\"icon\" onClick={handleInfoClick}>\n          <FaInfo />\n        </div>\n        <input\n          id=\"input-jabber-message\"\n          type=\"text\"\n          placeholder=\"说点什么？\"\n          value={chatText}\n          onChange={(e) => setChatText(e.target.value.trim())}\n          onKeyPress={(event) => {\n            if (event.key === \"Enter\") {\n              event.preventDefault();\n              handleJabber(event);\n            }\n          }}\n        />\n        <div className=\"icon\" onClick={handleJabber}>\n          <FaTelegramPlane />\n        </div>\n      </div>\n      <Person\n        ref={refPerson}\n        open={showPerson}\n        onOutsideClick={handlePersonClose}\n      />\n      <Info open={showInfo} onOutsideClick={handleInfoClose} />\n    </div>\n  );\n}\n","import React from \"react\";\nimport { BrowserRouter, Routes, Route, Navigate } from \"react-router-dom\";\nimport HomePage from \"./components/home_page\";\nimport Login from \"./components/login\";\nimport School from \"./components/school\";\nimport Teachers from \"./components/teachers\";\nimport Recipes from \"./components/recipes\";\nimport Chat from \"./components/chat\";\nimport Test from \"./components/test\";\nimport LivePlayer from \"./components/live_player\";\nimport { UserContext } from \"./user_context\";\nimport { default as SnackbarProvider } from \"./components/snackbar\";\nimport \"./components/normalize.css\";\nexport default function App(props) {\n  const updateUser = (user) => {\n    setUserContext({ ...userContext, user: user });\n  };\n\n  const [userContext, setUserContext] = React.useState({\n    user: props.user,\n    updateUser: updateUser\n  });\n\n  return (\n    <UserContext.Provider value={userContext}>\n      <SnackbarProvider>\n        <BrowserRouter>\n          <Routes>\n            <Route\n              path=\"/\"\n              element={\n                userContext.user.username ? (\n                  <HomePage />\n                ) : (\n                  <Navigate to=\"/login\" state={{ from: \"/\" }} />\n                )\n              }\n            />\n            <Route path=\"/login\" element={<Login />} />\n            <Route path=\"/school\" element={<School />} />\n            <Route path=\"/teachers\" element={<Teachers />} />\n            <Route\n              path=\"/chat\"\n              element={\n                userContext.user.username ? (\n                  <Chat />\n                ) : (\n                  <Navigate to=\"/login\" state={{ from: \"/chat\" }} />\n                )\n              }\n            />\n            <Route\n              path=\"/player\"\n              element={\n                userContext.user.username ? (\n                  <LivePlayer />\n                ) : (\n                  <Navigate to=\"/login\" state={{ from: \"/player\" }} />\n                )\n              }\n            />\n            <Route path=\"/recipes\" element={<Recipes />} />\n            <Route path=\"/test\" element={<Test />} />\n          </Routes>\n        </BrowserRouter>\n      </SnackbarProvider>\n    </UserContext.Provider>\n  );\n}\n","/**\nimport \"react-app-polyfill/ie11\";\nimport \"react-app-polyfill/stable\";\n*/\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport Cookies from \"js-cookie\";\nimport App from \"./App\";\n\n(() => {\n  let user = {};\n  user.username = Cookies.get(\"username\");\n  user.token = Cookies.get(\"token\");\n  user.role = Cookies.get(\"role\");\n\n  const rootElement = document.getElementById(\"root\");\n  ReactDOM.render(\n    <React.StrictMode>\n      <App user={user} />\n    </React.StrictMode>,\n    rootElement\n  );\n})();\n"],"sourceRoot":""}